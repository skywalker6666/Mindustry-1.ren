{"version":3,"file":"main.es.js","sources":["../src/components/common/base-widget.tsx","../src/components/common/drag-scroll-widget.tsx","../src/components/common/save-ref.tsx","../src/components/common/styled.tsx","../src/plugins/event.ts","../src/utils/icon.tsx","../src/utils/keys.ts","../src/utils/events.ts","../src/utils/file.ts","../src/utils/css.ts","../src/utils/index.ts","../src/plugins/get-value.ts","../src/plugins/hotkey.ts","../src/plugins/layout.tsx","../src/plugins/operation.ts","../src/plugins/react/components/topic-context-menu.tsx","../src/plugins/react/context-menu.tsx","../src/plugins/react/components/topic-drop-effect.tsx","../src/plugins/react/drag-and-drop.tsx","../src/plugins/react/components/editor-root-breadcrumbs.tsx","../src/plugins/react/components/mind-drag-scroll-widget.tsx","../src/plugins/react/components/modals.tsx","../src/plugins/react/components/root-sublinks.tsx","../src/plugins/react/components/root-widget.tsx","../src/plugins/react/components/topic-collapse-icon.tsx","../src/plugins/react/components/topic-content.tsx","../src/plugins/react/components/topic-content-widget.tsx","../src/plugins/react/components/topic-desc.tsx","../src/plugins/react/components/topic-highlight.tsx","../src/plugins/react/components/topic-sub-links.tsx","../src/plugins/react/components/topic-widget.tsx","../src/plugins/react/components/view-port-util/view-port-viewer.tsx","../src/plugins/react/drawer.tsx","../src/plugins/react/theme.tsx","../src/plugins/react/rendering.tsx","../src/plugins/react/components/right-top-panel/right-top-panel.tsx","../src/plugins/react/components/right-top-panel/styled.tsx","../src/plugins/react/components/right-top-panel/components.tsx","../src/plugins/react/components/style-editor/border-style-editor.tsx","../src/plugins/react/components/style-editor/clear-all-custom-style.tsx","../src/plugins/react/components/style-editor/link-style-editor.tsx","../src/plugins/react/components/style-editor/text-style-editor.tsx","../src/plugins/react/components/style-editor/style-editor.tsx","../src/utils/blueprint.ts","../src/plugins/react/components/style-editor/padding-style-editor.tsx","../src/plugins/react/components/theme-editor/topic-theme-editor.tsx","../src/plugins/react/components/theme-editor/theme-editor.tsx","../src/plugins/react/right-top-panel-plugin.tsx","../src/plugins/react/utils.tsx","../src/plugins/react/index.ts","../src/plugins/style.ts","../src/plugins/index.ts","../src/components/diagram.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { BaseProps } from './base-props';\n\nexport class BaseWidget<\n  P extends BaseProps = BaseProps,\n  S = any\n> extends React.PureComponent<P, S> {\n  constructor(props: P) {\n    super(props);\n  }\n\n  operation(opType: string, arg: any) {\n    this.props.controller.run('operation', {\n      opType,\n      ...arg\n    });\n  }\n\n  run(name: string, arg: any) {\n    this.props.controller.run(name, arg);\n  }\n\n  get topic() {\n    return this.props.model.getTopic(this.props.topicKey);\n  }\n}\n","import * as React from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled from 'styled-components';\n\nimport debug from 'debug';\nconst log = debug('node:drag-scroll-widget');\n\nconst DragScrollView = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n`;\n\nconst DragScrollContent = styled.div`\n  position: relative;\n  width: max-content;\n`;\n\nconst useWindowListener = false;\n\ninterface DragScrollWidgetProps {\n  mouseKey?: 'left' | 'right';\n  needKeyPressed?: boolean;\n  canDragFunc?: () => Boolean;\n  enableMouseWheel: boolean;\n  zoomFactor: number;\n  children: (\n    setViewBoxScroll: (left: number, top: number) => void,\n    setViewBoxScrollDelta: (left: number, top: number) => void\n  ) => React.ReactNode;\n}\n\nexport class DragScrollWidget extends React.Component<\n  DragScrollWidgetProps,\n  any\n> {\n  constructor(props: DragScrollWidgetProps) {\n    super(props);\n    this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n  }\n\n  static defaultProps = {\n    mouseKey: 'left',\n    needKeyPressed: false\n  };\n\n  contentResizeCallback = (\n    entries: ResizeObserverEntry[],\n    observer: ResizeObserver\n  ) => {\n    if (this.oldContentRect) {\n      const widgetStyle = {\n        width: this.content.clientWidth + this.viewBox.clientWidth * 2,\n        height: this.content.clientHeight + this.viewBox.clientHeight * 2\n      };\n      this.bigView.style.width = widgetStyle.width + 'px';\n      this.bigView.style.height = widgetStyle.height + 'px';\n    }\n    this.oldContentRect = entries[0].contentRect;\n  };\n\n  contentResizeObserver = new ResizeObserver(this.contentResizeCallback);\n  // oldScroll: { left: number; top: number };\n  oldContentRect: any;\n  content: HTMLElement;\n  contentRef = ref => {\n    if (ref) {\n      this.content = ref;\n      this.contentResizeObserver.observe(this.content);\n    }\n  };\n\n  viewBox: HTMLElement;\n  viewBoxRef = ref => {\n    if (ref) {\n      this.viewBox = ref;\n      if (!this.props.enableMouseWheel) {\n        log('addEventListener onwheel');\n        this.viewBox.addEventListener(\n          'wheel',\n          function(e) {\n            log('onwheel');\n            (e.ctrlKey || e.altKey) && e.preventDefault();\n          },\n          {\n            passive: false\n          }\n        );\n      }\n      this.setViewBoxScroll(\n        this.viewBox.clientWidth,\n        this.viewBox.clientHeight\n      );\n    }\n  };\n\n  bigView: HTMLElement;\n  bigViewRef = ref => {\n    if (ref) {\n      this.bigView = ref;\n    }\n  };\n\n  setWidgetStyle = () => {\n    if (this.content && this.viewBox && this.bigView) {\n      this.bigView.style.width =\n        (this.content.clientWidth + this.viewBox.clientWidth) * 2 + 'px';\n      this.bigView.style.height =\n        (this.content.clientHeight + this.viewBox.clientHeight) * 2 + 'px';\n\n      this.content.style.left = this.viewBox.clientWidth + 'px';\n      this.content.style.top = this.viewBox.clientHeight + 'px';\n    }\n  };\n\n  setViewBoxScroll = (left: number, top: number) => {\n    log(`setViewBoxScroll ${left} ${top}`);\n    if (this.viewBox) {\n      this.viewBox.scrollLeft = left;\n      this.viewBox.scrollTop = top;\n    }\n  };\n\n  setViewBoxScrollDelta = (deltaLeft: number, deltaTop: number) => {\n    log(`setViewBoxScrollDelta ${deltaLeft} ${deltaTop}`);\n    if (this.viewBox) {\n      this.viewBox.scrollLeft += deltaLeft;\n      this.viewBox.scrollTop += deltaTop;\n    }\n  };\n\n  onMouseDown = e => {\n    // log('Drag Scroll onMouseDown');\n    // log(e.nativeEvent.target);\n\n    // mouseKey 表示鼠标按下那个键才可以进行拖动，左键或者右键\n    // needKeyPressed 为了支持是否需要按下ctrl键，才可以进行拖动\n    // canDragFunc是一个函数，它是为了支持使用者以传入函数的方式，这个函数的返回值表示当前的内容是否可以被拖拽而移动\n    const { mouseKey, needKeyPressed, canDragFunc } = this.props;\n    if (canDragFunc && !canDragFunc()) return;\n    if (\n      (e.button === 0 && mouseKey === 'left') ||\n      (e.button === 2 && mouseKey === 'right')\n    ) {\n      if (needKeyPressed) {\n        if (!e.ctrlKey) return;\n      }\n      this._lastCoordX = this.viewBox.scrollLeft + e.nativeEvent.clientX;\n      this._lastCoordY = this.viewBox.scrollTop + e.nativeEvent.clientY;\n\n      const ele = useWindowListener ? window : this.viewBox;\n      ele.addEventListener('mousemove', this.onMouseMove);\n      ele.addEventListener('mouseup', this.onMouseUp);\n    }\n  };\n\n  onMouseUp = e => {\n    const ele = useWindowListener ? window : this.viewBox;\n    ele.removeEventListener('mousemove', this.onMouseMove);\n    ele.removeEventListener('mouseup', this.onMouseUp);\n  };\n\n  // _lastCoordX和_lastCorrdY 是为了在拖动过程中 计算 viewBox的scrollLeft和scrollTop值用到\n  // _lastCoordX和_lastCorrdY 记录下拖动开始时刻viewBox的scroll值和鼠标位置值\n  _lastCoordX: number;\n  _lastCoordY: number;\n\n  onMouseMove = (e: MouseEvent) => {\n    this.viewBox.scrollLeft = this._lastCoordX - e.clientX;\n    this.viewBox.scrollTop = this._lastCoordY - e.clientY;\n    // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n  };\n\n  handleContextMenu = e => {\n    e.preventDefault();\n  };\n\n  componentDidMount(): void {\n    this.setWidgetStyle();\n    document.addEventListener('contextmenu', this.handleContextMenu);\n  }\n\n  componentWillUnmount(): void {\n    document.removeEventListener('contextmenu', this.handleContextMenu);\n  }\n\n  setZoomFactor(zoomFactor) {\n    this.bigView.style.transform = `scale(${zoomFactor})`;\n    this.bigView.style.transformOrigin = '50% 50%';\n  }\n\n  render() {\n    const style = {\n      ...this.state.widgetStyle\n      // zoom:this.props.zoomFactor,\n      // transform: `scale(${this.props.zoomFactor})`,\n      // transformOrigin: '50% 50%'\n    };\n    return (\n      <DragScrollView ref={this.viewBoxRef} onMouseDown={this.onMouseDown}>\n        <div style={style} ref={this.bigViewRef}>\n          <DragScrollContent\n            ref={this.contentRef}\n            style={this.state.contentStyle}\n          >\n            {this.props.children(\n              this.setViewBoxScroll,\n              this.setViewBoxScrollDelta\n            )}\n          </DragScrollContent>\n        </div>\n      </DragScrollView>\n    );\n  }\n}\n","import debug from 'debug';\nimport * as React from 'react';\n\nconst log = debug('node:save-ref');\n\ninterface SaveRefProps {\n  children: (\n    saveRef: Function,\n    getRef: Function,\n    deleteRef: Function,\n    registerRefListener: Function\n  ) => React.ReactNode;\n}\n\ntype RefListener = (name: string, ref: HTMLElement) => void;\n\n//TODO 可能会引起内存泄露,在删除一个topic时\nexport class SaveRef extends React.Component<SaveRefProps> {\n  getRef = name => {\n    log(this);\n    return this[name];\n  };\n\n  saveRef = name => {\n    return node => {\n      if (node) {\n        this[name] = node;\n        this.fireListener(name, node);\n      }\n    };\n  };\n\n  deleteRef = name => {\n    log('deleteRef:', name);\n    delete this[name];\n  };\n\n  observers: Map<string, [RefListener]> = new Map();\n\n  fireListener = (name: string, ref: HTMLElement) => {\n    if (this.observers.has(name)) {\n      const listeners = this.observers.get(name);\n      for (const listener of listeners) {\n        listener(name, ref);\n      }\n    }\n  };\n\n  registerRefListener = (name, listener: RefListener) => {\n    if (!this.observers.has(name)) {\n      this.observers.set(name, [listener]);\n    } else {\n      this.observers.get(name).push(listener);\n    }\n  };\n\n  render() {\n    return this.props.children(\n      this.saveRef,\n      this.getRef,\n      this.deleteRef,\n      this.registerRefListener.bind(this)\n    );\n  }\n}\n","import { Checkbox } from '@blueprintjs/core';\nimport styled from 'styled-components';\n\nexport const Flex = styled.div`\n  display: flex;\n  flex-direction: ${props =>\n    props.flexDirection ? props.flexDirection : 'row'};\n  align-items: ${props => props.alignItems};\n  justify-content: ${props => props.justifyContent};\n`;\n\nexport const Margin = styled.div`\n  margin: ${props => props.margin};\n`;\n\nexport const ShowMenuIcon = styled.a`\n  font-size: 20px !important;\n`;\n\nexport const IconBg = styled.div`\n  padding: 5px;\n  cursor: pointer;\n`;\n\nexport const Btn = styled.div`\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n`;\n\nexport const StyledCheckbox = styled(Checkbox)`\n  margin-bottom: 0px !important;\n`;\n\nexport const CloseIcon = styled(Btn)`\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n`;\n\nexport const Title = styled.div`\n  height: 16px;\n`;\n\nexport const TopicBlockIcon = styled.span`\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n`;\n\nexport const ZIndex = styled.div`\n  z-index: ${props => props.zIndex};\n`;\n\nexport const PanelTabRoot = styled.div`\n  min-width: 360px;\n  max-height: 470px;\n  overflow: auto;\n`;\n","import { FocusMode, OpType } from '@blink-mind/core';\n\nimport debug from 'debug';\n\nconst log = debug('plugin:event');\n\nexport function EventPlugin() {\n  const eventListeners = {};\n  return {\n    handleTopicClick(props) {\n      log('handleTopicClick');\n      const { controller, model, topicKey } = props;\n      log(model.zoomFactor);\n      //TODO\n      if (model.editingDescKey !== null) return;\n      if (model.editingContentKey === topicKey) return;\n      if (\n        model.focusKey === topicKey &&\n        model.focusMode === FocusMode.EDITING_CONTENT\n      )\n        return;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      });\n    },\n\n    handleTopicDoubleClick(props) {\n      const { controller, model } = props;\n      if (model.editingDescKey !== null) return;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      });\n    },\n\n    handleTopicContextMenu(props) {\n      const { controller } = props;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      });\n    },\n\n    handleActiveModalClose(props) {\n      const { controller } = props;\n      const activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n      if (activeModalProps.name === 'edit-desc') {\n        return function() {\n          controller.run('operation', {\n            ...props,\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          });\n        };\n      }\n    },\n\n    addEventListener(props) {\n      const { key, listener, once, controller } = props;\n      if (!eventListeners[key]) eventListeners[key] = [];\n      if (once) {\n        only.origin = listener;\n        eventListeners[key].push(only);\n      } else {\n        eventListeners[key].push(listener);\n      }\n\n      function only() {\n        listener();\n        controller.run('removeEventListener', {\n          key,\n          listener\n        });\n      }\n    },\n\n    removeEventListener(props) {\n      const { key, listener } = props;\n      if (eventListeners[key]) {\n        eventListeners[key] = eventListeners[key].filter(fn => {\n          return fn !== listener && fn.origin !== listener;\n        });\n      }\n    },\n\n    fireEvent(props) {\n      const { key } = props;\n      if (eventListeners[key]) {\n        eventListeners[key].forEach(fn => fn());\n      }\n    }\n  };\n}\n","import * as React from 'react';\nexport const IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes',\n  PLUS: 'plus',\n  MINUS: 'minus',\n  COLLAPSE_ALL: 'collapse',\n  EXPAND_ALL: 'expand',\n  CENTER: 'center',\n  TRASH: 'trash',\n  SEARCH: 'search',\n  THEME: 'theme',\n  EXPORT: 'export',\n  OPEN_FILE: 'openfile'\n};\n\nexport function iconClassName(name) {\n  return `icon iconfont bm-${name}`;\n}\n\nexport function Icon(iconName) {\n  return <span className={iconClassName(iconName)} />;\n}\n","export function contentRefKey(key) {\n  return `content-${key}`;\n}\n\nexport function contentEditorRefKey(key) {\n  return `content-editor-${key}`;\n}\n\nexport function descEditorRefKey(key) {\n  return `desc-editor-${key}`;\n}\n\nexport function topicWidgetRefKey(key) {\n  return `topic-widget-${key}`;\n}\n\nexport function topicRefKey(key) {\n  return `topic-${key}`;\n}\n\nexport function linksRefKey(key) {\n  return `links-${key}`;\n}\n\nexport function linksSvgRefKey(key) {\n  return `links-svg-${key}`;\n}\n\nexport function collapseRefKey(key) {\n  return `collapse-${key}`;\n}\n\nexport function dropAreaRefKey(key, dir) {\n  return `dropArea-${dir}-${key}`;\n}\n\nexport const RefKey = {\n  DIAGRAM_ROOT_KEY: 'DIAGRAM-ROOT',\n  DRAG_SCROLL_WIDGET_KEY: 'DragScrollWidget',\n  SVG_HIGHLIGHT_KEY: 'svg-highlight',\n  FOCUS_HIGHLIGHT_KEY: 'focus-highlight',\n  DROP_EFFECT_KEY: 'drop-effect'\n};\nexport const EventKey = {\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC'\n};\n\nexport const PropKey = {\n  DIAGRAM_CUSTOMIZE_BASE_Z_INDEX: 'DIAGRAM_CUSTOMIZE_BASE_Z_INDEX',\n  TOPIC_CONTEXT_MENU_ENABLED: 'TOPIC_CONTEXT_MENU_ENABLED',\n  TOPIC_TITLE: 'TOPIC_TITLE'\n};\n","export const cancelEvent = e => {\n  e.stopPropagation();\n};\n","export function browserDownloadFile(url: string, filename: string) {\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  link.click();\n}\n\nexport function browserDownloadText(text: string, filename: string) {\n  const url = `data:text/plain,${encodeURIComponent(text)}`;\n  browserDownloadFile(url, filename);\n}\n\nexport function browserOpenFile(accept: string): Promise<any> {\n  const input = document.createElement('input');\n  input.type = 'file';\n  input.accept = accept;\n\n  return new Promise<string>((resolve, reject) => {\n    input.addEventListener('change', evt => {\n      //@ts-ignore\n      const file = evt.target.files[0];\n      const fr = new FileReader();\n\n      fr.onload = (evt: ProgressEvent<FileReader>) => {\n        const txt = evt.target.result;\n        //@ts-ignore\n        resolve(txt);\n      };\n      fr.onerror = (evt: ProgressEvent<FileReader>) => {\n        reject(evt.target.error);\n      };\n      fr.readAsText(file);\n    });\n    input.click();\n  });\n}\n","export function paddingCss(arg: {\n  top: number;\n  right: number;\n  bottom: number;\n  left: number;\n}) {\n  const { top = 0, right = 0, bottom = 0, left = 0 } = arg;\n  return `${top}px ${right}px ${bottom}px ${left}px`;\n}\n","import { KeyType } from '@blink-mind/core';\n\nexport function getLinkKey(fromKey: KeyType, toKey: KeyType) {\n  return `link-${fromKey}-${toKey}`;\n}\n\nexport type Point = {\n  x: number;\n  y: number;\n};\n\nexport function centerY(rect: ClientRect) {\n  return (rect.top + rect.bottom) / 2;\n}\n\nexport function centerX(rect: ClientRect) {\n  return (rect.left + rect.right) / 2;\n}\n\nexport function centerPointX(p1, p2) {\n  return (p1.x + p2.x) / 2;\n}\n\nexport function centerPointY(p1, p2) {\n  return (p1.y + p2.y) / 2;\n}\n\nexport function center(rect) {\n  return [(rect.left + rect.right) / 2, (rect.top + rect.bottom) / 2];\n}\nexport function getRelativeRect(\n  el: HTMLElement,\n  rel: HTMLElement,\n  scale: number = 1\n) {\n  const rect = el.getBoundingClientRect();\n  const relRect = rel.getBoundingClientRect();\n\n  const relCenter = center(relRect);\n  const elCenter = center(rect);\n  elCenter[0] = (elCenter[0] - relCenter[0]) / scale;\n  elCenter[1] = (elCenter[1] - relCenter[1]) / scale;\n  const width = rect.width / scale;\n  const height = rect.height / scale;\n  return {\n    left: elCenter[0] - width / 2,\n    right: elCenter[0] + width / 2,\n    top: elCenter[1] - height / 2,\n    bottom: elCenter[1] + height / 2,\n    width,\n    height\n  };\n}\n\nexport function getRelativeVector(el: HTMLElement, rel: HTMLElement) {\n  const rect = el.getBoundingClientRect();\n  const relRect = rel.getBoundingClientRect();\n  const relCenter = center(relRect);\n  const elCenter = center(rect);\n  return [elCenter[0] - relCenter[0], elCenter[1] - relCenter[1]];\n}\n\nexport * from './icon';\nexport * from './keys';\nexport * from './events';\nexport * from './file';\nexport * from './css';\n","import { PropKey } from '../utils';\n\nexport function GetValuePlugin() {\n  return {\n    getValue(props, next) {\n      const { propKey, controller } = props;\n      switch (propKey) {\n        case PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:\n          return 3;\n        case PropKey.TOPIC_CONTEXT_MENU_ENABLED:\n          return controller.run('isOperationEnabled', props);\n        case PropKey.TOPIC_TITLE:\n          return controller.run('getTopicTitle', props);\n      }\n      return next();\n    }\n  };\n}\n","import { OpType } from '@blink-mind/core';\n\nexport interface HotKeyItem {\n  label: string;\n  combo: string;\n  onKeyDown: (e: KeyboardEvent) => any;\n}\n\nexport type HotKeyMap = Map<string, HotKeyItem>;\n\nexport interface HotKeysConfig {\n  topicHotKeys: HotKeyMap;\n  globalHotKeys: HotKeyMap;\n}\n\nexport const HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_CONTENT: 'EDIT_CONTENT',\n  EDIT_NOTES: 'EDIT_NOTES',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\n\nfunction op(opType: string, props) {\n  const { topicKey, model, controller } = props;\n  if (topicKey === undefined) {\n    props = { ...props, topicKey: model.focusKey };\n  }\n  controller.run('operation', { ...props, opType });\n}\n\nexport function HotKeyPlugin() {\n  return {\n    customizeHotKeys(props): HotKeysConfig {\n      const handleKeyDown = opType => e => {\n        // log('HotKeyPlugin', opType);\n        op(opType, props);\n      };\n      const topicHotKeys = new Map<string, HotKeyItem>([\n        [\n          HotKeyName.ADD_CHILD,\n          {\n            label: 'add child',\n            combo: 'tab',\n            onKeyDown: handleKeyDown(OpType.ADD_CHILD)\n          }\n        ],\n        [\n          HotKeyName.ADD_SIBLING,\n          {\n            label: 'add sibling',\n            combo: 'enter',\n            onKeyDown: handleKeyDown(OpType.ADD_SIBLING)\n          }\n        ],\n        [\n          HotKeyName.DELETE_TOPIC,\n          {\n            label: 'delete topic',\n            combo: 'del',\n            onKeyDown: handleKeyDown(OpType.DELETE_TOPIC)\n          }\n        ],\n        [\n          HotKeyName.EDIT_CONTENT,\n          {\n            label: 'edit content',\n            combo: 'space',\n            onKeyDown: handleKeyDown(OpType.START_EDITING_CONTENT)\n          }\n        ],\n        [\n          HotKeyName.EDIT_NOTES,\n          {\n            label: 'edit notes',\n            combo: 'alt + d',\n            onKeyDown: handleKeyDown(OpType.START_EDITING_DESC)\n          }\n        ],\n        [\n          HotKeyName.SET_EDITOR_ROOT,\n          {\n            label: 'set editor root',\n            combo: 'alt + shift + f',\n            onKeyDown: handleKeyDown(OpType.SET_EDITOR_ROOT)\n          }\n        ]\n      ]);\n      const globalHotKeys = new Map();\n      return {\n        topicHotKeys,\n        globalHotKeys\n      };\n    }\n  };\n}\n","import {\n  DiagramLayoutType,\n  FocusMode,\n  getRelationship,\n  KeyType,\n  Model,\n  ModelModifier,\n  OpType,\n  Topic,\n  TopicRelationship\n} from '@blink-mind/core';\nimport {\n  getRelativeRect,\n  getRelativeVector,\n  linksRefKey,\n  RefKey,\n  topicRefKey,\n  topicWidgetRefKey\n} from '../utils';\nimport { RootSubLinks } from './react/components/root-sublinks';\nimport { TopicDropEffect } from './react/components/topic-drop-effect';\nimport { TopicHighlight } from './react/components/topic-highlight';\nimport { TopicWidget } from './react/components/topic-widget';\n\nexport type GetPartTopicsArg = {\n  layout: DiagramLayoutType;\n  model: Model;\n  topicKey: KeyType;\n};\nexport interface GetPartTopicsRes {\n  [part: number]: KeyType[];\n}\n\nexport function LayoutPlugin() {\n  const _zoomFactor = 1;\n  return {\n    getPartTopics({\n      layout,\n      model,\n      topicKey\n    }: GetPartTopicsArg): GetPartTopicsRes {\n      const topic = model.getTopic(topicKey);\n      const subTopicCount = topic.subKeys.size;\n      const topics = topic.subKeys.toArray();\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return { R: topics };\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return { L: topics };\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n\n    createSubTopics(props) {\n      const { model, topicKey, controller, topics, saveRef } = props;\n      const topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      const subTopics = [];\n      topics.forEach(tKey => {\n        const topicProps = {\n          ...props,\n          topicKey: tKey,\n          key: tKey,\n          ref: saveRef(topicWidgetRefKey(tKey))\n        };\n        subTopics.push(controller.run('renderTopicWidget', topicProps));\n      });\n      return { subTopics };\n    },\n\n    layout(props) {\n      const { getRef, model } = props;\n      const links = getRef(\n        linksRefKey(model.editorRootTopicKey)\n      ) as RootSubLinks;\n      const highlight = getRef(RefKey.FOCUS_HIGHLIGHT_KEY) as TopicHighlight;\n      const dropEffect = getRef(RefKey.DROP_EFFECT_KEY) as TopicDropEffect;\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n\n      const editorRootTopic = model.getTopic(model.editorRootTopicKey);\n      layoutTopic(editorRootTopic);\n\n      function layoutTopic(topic: Topic) {\n        if (topic.key !== model.editorRootTopicKey) {\n          const topicWidget = getRef(\n            topicWidgetRefKey(topic.key)\n          ) as TopicWidget;\n          topicWidget && topicWidget.layoutLinks();\n        }\n        if (!topic.collapse) {\n          for (const subKey of topic.subKeys) {\n            layoutTopic(model.getTopic(subKey));\n          }\n        }\n      }\n    },\n\n    setLayoutDir(props) {\n      const { layoutDir, model, controller } = props;\n      controller.change(ModelModifier.setLayoutDir({ model, layoutDir }));\n    },\n\n    getRelativeRect(props) {\n      const { element, controller, getRef } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      return getRelativeRect(element, bigView, zoomFactor);\n    },\n\n    getRelativeRectFromViewPort(props) {\n      const { element, controller, getRef } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      const viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeRect(element, viewBox, zoomFactor);\n    },\n    getRelativeVectorFromViewPort(props) {\n      const { element, getRef } = props;\n      const viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeVector(element, viewBox);\n    },\n\n    addZoomFactorChangeEventListener(props) {\n      const { controller } = props;\n      controller.run('addTempValueChangeListener', {\n        key: 'ZoomFactor',\n        ...props\n      });\n    },\n\n    removeZoomFactorChangeEventListener(props) {\n      const { controller } = props;\n      controller.run('removeTempValueChangeListener', {\n        key: 'ZoomFactor',\n        ...props\n      });\n    },\n\n    setZoomFactor(props) {\n      const { controller, zoomFactor } = props;\n      return controller.run('setTempValue', {\n        key: 'ZoomFactor',\n        value: zoomFactor\n      });\n    },\n\n    getZoomFactor(props) {\n      const { controller } = props;\n      return (\n        controller.run('getTempValue', { key: 'ZoomFactor' }) || _zoomFactor\n      );\n    },\n\n    moveTopicToCenter(props) {\n      const { getRef, topicKey, model } = props;\n      if (\n        model.editorRootTopicKey !== topicKey &&\n        getRelationship(model, topicKey, model.editorRootTopicKey) !==\n          TopicRelationship.DESCENDANT\n      ) {\n        throw new Error(\n          `moveTopicToCenter error: topicKey ${topicKey} is not the DESCENDANT of editor root topic`\n        );\n      }\n      const topic = getRef(topicRefKey(topicKey));\n      const dragScroll = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n      const viewBox = dragScroll.viewBox;\n      if (!topic || !viewBox) {\n        throw new Error(`moveTopicToCenter error: topic or viewBox is null`);\n      }\n      const vector = getRelativeVector(topic, viewBox);\n      //TODO\n      dragScroll.setViewBoxScrollDelta(vector[0], vector[1]);\n    },\n\n    focusTopicAndMoveToCenter(props) {\n      const { controller, topicKey } = props;\n      controller.run('operation', {\n        ...props,\n        opArray: [\n          {\n            opType: OpType.FOCUS_TOPIC,\n            topicKey,\n            focusMode: FocusMode.NORMAL\n          },\n          {\n            opType: OpType.EXPAND_TO,\n            topicKey\n          }\n        ],\n        callback: () => {\n          controller.run('moveTopicToCenter', { ...props, topicKey });\n        }\n      });\n    }\n  };\n}\n","import {\n  BaseModifierArg,\n  BlockType,\n  FocusMode,\n  getAllSubTopicKeys,\n  Model,\n  ModelModifier,\n  OpType\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport { List, Stack } from 'immutable';\nimport {\n  collapseRefKey,\n  contentEditorRefKey,\n  contentRefKey,\n  descEditorRefKey,\n  dropAreaRefKey,\n  linksRefKey,\n  linksSvgRefKey,\n  topicRefKey,\n  topicWidgetRefKey\n} from '../utils';\nconst log = debug('plugin:operation');\n\nexport function OperationPlugin() {\n  const startEditingContent = ({ model, topicKey }: BaseModifierArg) => {\n    return ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n  const startEditingDesc = ({ model, topicKey }: BaseModifierArg) => {\n    const topic = model.getTopic(topicKey);\n    const desc = topic.getBlock(BlockType.DESC);\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setBlockData({\n        model,\n        topicKey,\n        blockType: BlockType.DESC,\n        data: ''\n      });\n    }\n    model = ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n    return model;\n  };\n\n  function dragAndDrop(props) {\n    const { srcKey, dstKey, dropDir } = props;\n    let { model } = props;\n    const srcTopic = model.getTopic(srcKey);\n    const dstTopic = model.getTopic(dstKey);\n\n    const srcParentKey = srcTopic.parentKey;\n    const srcParentTopic = model.getTopic(srcParentKey);\n    let srcParentSubKeys = srcParentTopic.subKeys;\n    const srcIndex = srcParentSubKeys.indexOf(srcKey);\n\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      let dstSubKeys = dstTopic.subKeys;\n      dstSubKeys = dstSubKeys.push(srcKey);\n      model = model.withMutations(m => {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys)\n          .setIn(['topics', srcKey, 'parentKey'], dstKey)\n          .setIn(['topics', dstKey, 'subKeys'], dstSubKeys)\n          .setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      const dstParentKey = dstTopic.parentKey;\n      const dstParentItem = model.getTopic(dstParentKey);\n      let dstParentSubKeys = dstParentItem.subKeys;\n      const dstIndex = dstParentSubKeys.indexOf(dstKey);\n      //src 和 dst 的父亲相同，这种情况要做特殊处理\n      if (srcParentKey === dstParentKey) {\n        let newDstParentSubKeys = List();\n        dstParentSubKeys.forEach(key => {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys = newDstParentSubKeys\n                  .push(srcKey)\n                  .push(key);\n              } else {\n                newDstParentSubKeys = newDstParentSubKeys\n                  .push(key)\n                  .push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys = newDstParentSubKeys.push(key);\n            }\n          }\n        });\n        model = model.withMutations(m => {\n          m.setIn(['topics', dstParentKey, 'subKeys'], newDstParentSubKeys);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex + 1, srcKey);\n        }\n        model = model.withMutations(m => {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys)\n            .setIn(['topics', srcKey, 'parentKey'], dstParentKey)\n            .setIn(['topics', dstParentKey, 'subKeys'], dstParentSubKeys)\n            .setIn(['topics', dstParentKey, 'collapse'], false);\n        });\n      }\n    }\n    return model;\n  }\n  const OpMap = new Map([\n    [OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse],\n    [OpType.COLLAPSE_ALL, ModelModifier.collapseAll],\n    [OpType.EXPAND_ALL, ModelModifier.expandAll],\n    [OpType.EXPAND_TO, ModelModifier.expandTo],\n    [OpType.ADD_CHILD, ModelModifier.addChild],\n    [OpType.ADD_SIBLING, ModelModifier.addSibling],\n    [OpType.DELETE_TOPIC, ModelModifier.deleteTopic],\n    [OpType.FOCUS_TOPIC, ModelModifier.focusTopic],\n    [OpType.SET_FOCUS_MODE, ModelModifier.setFocusMode],\n    [OpType.SET_STYLE, ModelModifier.setStyle],\n    [OpType.SET_THEME, ModelModifier.setTheme],\n    [OpType.SET_TOPIC_BLOCK, ModelModifier.setBlockData],\n    [OpType.DELETE_TOPIC_BLOCK, ModelModifier.deleteBlock],\n    [OpType.START_EDITING_CONTENT, startEditingContent],\n    [OpType.START_EDITING_DESC, startEditingDesc],\n    [OpType.DRAG_AND_DROP, dragAndDrop],\n    [OpType.SET_EDITOR_ROOT, ModelModifier.setEditorRootTopicKey]\n  ]);\n\n  let undoStack = Stack<Model>();\n  let redoStack = Stack<Model>();\n\n  let enabled = true;\n  let whiteListOperation = new Set<string>();\n\n  return {\n    isOperationEnabled(props) {\n      return enabled;\n    },\n\n    enableOperation() {\n      enabled = true;\n    },\n\n    disableOperation({ whiteList }) {\n      enabled = false;\n      if (whiteList) whiteListOperation = new Set(whiteList);\n      else whiteListOperation.clear();\n    },\n\n    /** plugin can extend Operation Map\n     * for example: A plugin can write a function\n     * getOpMap(props,next) {\n     *   let opMap = next();\n     *   opMap.set(\"OpTypeName\",opFunc);\n     *   return opMap;\n     * }\n     * @param props\n     */\n    getOpMap(props) {\n      return OpMap;\n    },\n    getAllowUndo(props) {\n      const { model, opType } = props;\n      if (opType) {\n        switch (opType) {\n          case OpType.FOCUS_TOPIC:\n          case OpType.START_EDITING_CONTENT:\n          case OpType.START_EDITING_DESC:\n            return false;\n          default:\n            break;\n        }\n      }\n      switch (model.focusMode) {\n        case 'EDITING_DESC':\n        case 'EDITING_CONTENT':\n          return false;\n      }\n      return model.config.allowUndo;\n    },\n\n    getUndoRedoStack() {\n      return {\n        undoStack,\n        redoStack\n      };\n    },\n\n    setUndoStack(props) {\n      log('setUndoStack', props.undoStack);\n      undoStack = props.undoStack;\n    },\n\n    setRedoStack(props) {\n      log('setRedoStack', props.redoStack);\n      redoStack = props.redoStack;\n    },\n\n    canUndo(props) {\n      const { controller } = props;\n      const { undoStack } = controller.run('getUndoRedoStack', props);\n      const allowUndo = controller.run('getAllowUndo', props);\n      return undoStack.size > 0 && allowUndo;\n    },\n\n    canRedo(props) {\n      const { controller } = props;\n      const { redoStack } = controller.run('getUndoRedoStack', props);\n      const allowUndo = controller.run('getAllowUndo', props);\n      return redoStack.size > 0 && allowUndo;\n    },\n\n    undo(props) {\n      const { controller, model } = props;\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n      const { undoStack, redoStack } = controller.run(\n        'getUndoRedoStack',\n        props\n      );\n      const newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', {\n        ...props,\n        undoStack: undoStack.shift()\n      });\n      controller.run('setRedoStack', {\n        ...props,\n        redoStack: redoStack.push(model)\n      });\n      log(newModel);\n      controller.change(newModel);\n    },\n\n    redo(props) {\n      const { controller, model } = props;\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n      const { undoStack, redoStack } = controller.run(\n        'getUndoRedoStack',\n        props\n      );\n      const newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', {\n        ...props,\n        undoStack: undoStack.push(model)\n      });\n      controller.run('setRedoStack', {\n        ...props,\n        redoStack: redoStack.shift()\n      });\n      controller.change(newModel);\n    },\n\n    //TODO 有空重构这个函数\n    operation(props) {\n      const { controller, opType, model, opArray, callback } = props;\n      if (opArray != null && !Array.isArray(opArray)) {\n        throw new Error('operation: the type of opArray must be array!');\n      }\n      if (opType != null && opArray != null) {\n        throw new Error('operation: opType and opArray conflict!');\n      }\n      const isOperationEnabled = controller.run('isOperationEnabled', props);\n      if (!isOperationEnabled) {\n        // warning(\n        //   true,\n        //   `You have disabled operation,but you run operation ${props} now!`\n        // );\n        if (whiteListOperation.size === 0) return;\n\n        if (opArray != null) {\n          const opNotInWhiteList = opArray.filter(\n            op => !whiteListOperation.has(op.opType)\n          );\n          if (opNotInWhiteList && opNotInWhiteList.length > 0) {\n            return;\n          }\n        } else if (!whiteListOperation.has(opType)) {\n          return;\n        }\n      }\n\n      log('operation:', opType);\n      log('operation:', model);\n      log('operation:', props);\n\n      const opMap = controller.run('getOpMap', props);\n      controller.run('beforeOperation', props);\n      if (controller.run('getAllowUndo', props)) {\n        const { undoStack } = controller.run('getUndoRedoStack', props);\n        controller.run('setUndoStack', {\n          ...props,\n          undoStack: undoStack.push(model)\n        });\n      }\n      let newModel;\n\n      if (opArray != null) {\n        newModel = opArray.reduce((acc, cur) => {\n          const { opType } = cur;\n          if (!opMap.has(opType))\n            throw new Error(`opType:${opType} not exist!`);\n          const opFunc = opMap.get(opType);\n          const opFuncProps = { controller, ...cur, model: acc };\n          let res = controller.run('beforeOpFunction', opFuncProps);\n          res = opFunc({ ...opFuncProps, model: res });\n          res = controller.run('afterOpFunction', {\n            ...opFuncProps,\n            model: res\n          });\n          return res;\n        }, model);\n      } else {\n        if (!opMap.has(opType)) throw new Error(`opType:${opType} not exist!`);\n        const opFunc = opMap.get(opType);\n        newModel = controller.run('beforeOpFunction', props);\n        newModel = opFunc({ ...props, model: newModel });\n        newModel = controller.run('afterOpFunction', {\n          ...props,\n          model: newModel\n        });\n      }\n      log('newModel:', newModel);\n      controller.change(newModel, callback);\n      controller.run('afterOperation', props);\n    },\n\n    deleteRefKey(props) {\n      const { model, topicKey, deleteRef } = props;\n      const allSubKeys = getAllSubTopicKeys(model, topicKey);\n      allSubKeys.push(topicKey);\n      for (const key of allSubKeys) {\n        deleteRef(linksRefKey(key));\n        deleteRef(linksSvgRefKey(key));\n        deleteRef(contentRefKey(key));\n        deleteRef(contentEditorRefKey(key));\n        deleteRef(descEditorRefKey(key));\n        deleteRef(topicWidgetRefKey(key));\n        deleteRef(topicRefKey(key));\n        deleteRef(collapseRefKey(key));\n        deleteRef(dropAreaRefKey(key, 'next'));\n        deleteRef(dropAreaRefKey(key, 'prev'));\n      }\n    },\n\n    // 在整个Operation执行之前被调用\n    beforeOperation(props) {},\n    afterOperation(props) {},\n\n    // 在单个OpFunction执行之前被调用\n    beforeOpFunction(props) {\n      const { controller, opType, model, topicKey } = props;\n      if (\n        opType === OpType.DELETE_TOPIC &&\n        topicKey !== model.editorRootTopicKey\n      ) {\n        controller.run('deleteRefKey', props);\n      }\n      return model;\n    },\n\n    afterOpFunction(props) {\n      return props.model;\n    }\n  };\n}\n","import { Menu } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { BaseWidget } from '../../../components/common';\n\nexport class TopicContextMenu extends BaseWidget {\n  render() {\n    const { controller } = this.props;\n    return (\n      <Menu>{controller.run('customizeTopicContextMenu', this.props)}</Menu>\n    );\n  }\n}\n","import { OpType } from '@blink-mind/core';\nimport { MenuItem } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { Icon } from '../../utils';\nimport { TopicContextMenu } from './components/topic-context-menu';\n\nexport type TopicContextMenuItemConfig = {\n  icon?: string;\n  label?: string;\n  shortcut?: string;\n  opType?: string;\n  rootCanUse?: boolean;\n  hotKey?: string;\n};\n\nconst items: TopicContextMenuItemConfig[] = [\n  {\n    icon: 'edit',\n    label: 'edit',\n    shortcut: 'Space',\n    rootCanUse: true,\n    opType: OpType.START_EDITING_CONTENT\n  },\n  {\n    icon: 'add-sibling',\n    label: 'add sibling',\n    shortcut: 'Enter',\n    opType: OpType.ADD_SIBLING\n  },\n  {\n    icon: 'add-child',\n    label: 'add child',\n    shortcut: 'Tab',\n    rootCanUse: true,\n    opType: OpType.ADD_CHILD\n  },\n  {\n    icon: 'notes',\n    label: 'edit notes',\n    shortcut: 'Alt + D',\n    rootCanUse: true,\n    opType: OpType.START_EDITING_DESC\n  },\n  {\n    icon: 'delete-node',\n    label: 'delete node',\n    shortcut: 'Del',\n    opType: OpType.DELETE_TOPIC\n  },\n  {\n    icon: 'root',\n    label: 'set as editor root',\n    shortcut: 'Alt + Shift + F',\n    opType: OpType.SET_EDITOR_ROOT\n  }\n];\n\nexport function ContextMenuPlugin() {\n  return {\n    renderTopicContextMenu(props) {\n      return <TopicContextMenu {...props} />;\n    },\n    customizeTopicContextMenu(props) {\n      const { topicKey, model, controller } = props;\n      const isRoot = topicKey === model.editorRootTopicKey;\n      function onClickItem(item) {\n        return function(e) {\n          item.opType &&\n            controller.run('operation', { ...props, opType: item.opType });\n        };\n      }\n      return items.map(item =>\n        isRoot && !item.rootCanUse ? null : (\n          <MenuItem\n            key={item.label}\n            icon={Icon(item.icon)}\n            text={item.label}\n            labelElement={<kbd>{item.shortcut}</kbd>}\n            onClick={onClickItem(item)}\n          />\n        )\n      );\n    }\n  };\n}\n","import debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  contentRefKey,\n  dropAreaRefKey,\n  getRelativeRect,\n  RefKey\n} from '../../../utils';\nconst log = debug('node:topic-drop-effect');\n\nconst DropEffectSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n`;\n\ninterface State {\n  content: any;\n}\n\nexport class TopicDropEffect extends BaseWidget<BaseProps, State> {\n  state = {\n    content: null\n  };\n\n  layout() {\n    const props = this.props;\n    const { getRef, model, zoomFactor, controller } = this.props;\n    const targetProps = controller.run('getDragTargetProps', props);\n    const { key, dropDir } = targetProps;\n    log('layout', dropDir);\n\n    if (key === null) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n    let refKey;\n    if (dropDir === 'in') {\n      refKey = contentRefKey(key);\n    } else {\n      refKey = dropAreaRefKey(key, dropDir);\n    }\n    const content = getRef(refKey);\n    const svg = getRef('svg-drop-effect');\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const contentRect = getRelativeRect(content, bigView, zoomFactor);\n    const svgRect = getRelativeRect(svg, bigView, zoomFactor);\n    const padding = 3;\n    const x = contentRect.left - svgRect.left - padding;\n    const y = contentRect.top - svgRect.top - padding;\n    const width = contentRect.width + 2 * padding;\n    const height = contentRect.height + 2 * padding;\n\n    this.setState({\n      content: (\n        <g>\n          <rect\n            x={x}\n            y={y}\n            width={width}\n            height={height}\n            fill=\"none\"\n            stroke={model.config.theme.highlightColor}\n            strokeDasharray=\"5,5\"\n            strokeWidth={2}\n          />\n        </g>\n      )\n    });\n  }\n\n  render() {\n    const { saveRef } = this.props;\n    return (\n      <DropEffectSvg ref={saveRef('svg-drop-effect')}>\n        {this.state.content}\n      </DropEffectSvg>\n    );\n  }\n}\n","import {\n  FocusMode,\n  getRelationship,\n  OpType,\n  TopicRelationship\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { contentRefKey, dropAreaRefKey, RefKey } from '../../utils';\nimport { TopicDropEffect } from './components/topic-drop-effect';\nconst log = debug('plugin:drag-and-drop');\nconst DropArea = styled.div`\n  height: ${props => `${props.height}px`};\n  width: 100%;\n  margin: 5px 0px;\n`;\n\nexport function DragAndDropPlugin() {\n  let dragTargetKey: KeyType = null;\n  let dragTargetDir: string = null;\n\n  return {\n    renderTopicDropArea(props) {\n      const { topicKey, dropDir, saveRef, controller, model } = props;\n      const onDragEnter = ev => {\n        log('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', { ...props, ev, dropDir });\n      };\n      const onDragLeave = ev => {\n        log('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', { ...props, ev, dropDir });\n      };\n      const onDragOver = ev => {\n        ev.preventDefault();\n      };\n      const onDrop = ev => {\n        log('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', { ...props, ev, dropDir });\n      };\n      const eventHandlers = {\n        onDragEnter,\n        onDragLeave,\n        onDragOver,\n        onDrop\n      };\n      return (\n        <DropArea\n          height={model.config.theme.marginV / 2}\n          ref={saveRef(dropAreaRefKey(topicKey, dropDir))}\n          {...eventHandlers}\n        />\n      );\n    },\n\n    renderDragAndDropEffect(props) {\n      log('renderDragAndDropEffect');\n      const { saveRef } = props;\n      return (\n        <TopicDropEffect\n          ref={saveRef(RefKey.DROP_EFFECT_KEY)}\n          {...props}\n        ></TopicDropEffect>\n      );\n    },\n\n    getDragTargetProps(props) {\n      return {\n        key: dragTargetKey,\n        dropDir: dragTargetDir\n      };\n    },\n\n    handleTopicDragStart(props) {\n      const { controller, ev } = props;\n      ev.stopPropagation();\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      });\n    },\n\n    canDrop(props) {\n      const { srcKey, dstKey, model, dropDir } = props;\n      if (\n        srcKey === model.editorRootTopicKey ||\n        srcKey === dstKey ||\n        getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR\n      )\n        return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n\n      const srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n\n    handleTopicDragEnter(props) {\n      const { dropDir, topicKey, controller, model } = props;\n      log('handleTopicDragEnter:', topicKey, dropDir);\n      const canDrop = controller.run('canDrop', {\n        ...props,\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      if (canDrop) {\n        dragTargetKey = topicKey;\n        dragTargetDir = dropDir;\n        controller.change(model);\n      }\n    },\n\n    handleTopicDragLeave(props) {\n      const { controller, model, topicKey, dropDir, getRef, ev } = props;\n      const relatedTarget = ev.nativeEvent.relatedTarget;\n      log('handleTopicDragLeave:', topicKey, dropDir);\n      const content = getRef(contentRefKey(topicKey));\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n      dragTargetKey = null;\n      dragTargetDir = null;\n      controller.change(model);\n    },\n\n    handleTopicDrop(props) {\n      log('handleTopicDrop');\n      const { controller, topicKey, model } = props;\n      props = { ...props, srcKey: model.focusKey, dstKey: topicKey };\n\n      dragTargetKey = null;\n      dragTargetDir = null;\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', {\n          ...props,\n          opType: OpType.DRAG_AND_DROP\n        });\n      }\n    }\n  };\n}\n","import { ModelModifier } from '@blink-mind/core';\nimport {\n  Breadcrumb,\n  Breadcrumbs,\n  PopoverPosition,\n  Tooltip\n} from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget, ZIndex } from '../../../components/common';\nimport { PropKey } from '../../../utils';\n\nconst EditorRootBreadcrumbsRoot = styled(ZIndex)`\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n`;\n\nconst TooltipContent = styled.div`\n  max-width: 600px;\n`;\n\nconst BreadcrumbTitle = styled.span``;\n\nexport class EditorRootBreadcrumbs extends BaseWidget {\n  constructor(props) {\n    super(props);\n    this.state = {\n      show: false\n    };\n  }\n\n  setEditorRootTopicKey = topicKey => () => {\n    const { model, controller } = this.props;\n    if (model.editorRootTopicKey !== topicKey) {\n      controller.change(\n        ModelModifier.setEditorRootTopicKey({\n          model,\n          topicKey\n        })\n      );\n    }\n  };\n\n  breadcrumbRenderer = props => {\n    const { text, ...breadProps } = props;\n    const needTooltip = text.length > 8;\n    const title = needTooltip ? text.substr(0, 8) + '...' : text;\n    //TODO\n\n    const content = <TooltipContent>{text}</TooltipContent>;\n    const tooltipProps = {\n      content,\n      position: PopoverPosition.BOTTOM_RIGHT\n    };\n    const breadcrumb = (\n      <Breadcrumb {...breadProps}>\n        <BreadcrumbTitle>{title}</BreadcrumbTitle>\n      </Breadcrumb>\n    );\n    return needTooltip ? (\n      <Tooltip {...tooltipProps}>{breadcrumb}</Tooltip>\n    ) : (\n      breadcrumb\n    );\n\n    // return (\n    //   <Breadcrumb {...breadProps}>\n    //     <BreadcrumbTitle>{title}</BreadcrumbTitle>\n    //   </Breadcrumb>\n    // );\n  };\n\n  render() {\n    const props = this.props;\n    const { model, controller, zIndex } = props;\n    const editingRootKey = model.editorRootTopicKey;\n    if (editingRootKey === model.rootTopicKey) return null;\n\n    const items = [];\n    let topic = model.getTopic(editingRootKey);\n    while (topic != null) {\n      const title = controller.getValue(PropKey.TOPIC_TITLE, {\n        ...props,\n        topicKey: topic.key\n      });\n      items.unshift({\n        text: title,\n        onClick: this.setEditorRootTopicKey(topic.key)\n      });\n      topic = model.getTopic(topic.parentKey);\n    }\n    const breadcrumbProps = {\n      items,\n      breadcrumbRenderer: this.breadcrumbRenderer\n    };\n    return (\n      <EditorRootBreadcrumbsRoot zIndex={zIndex}>\n        <Breadcrumbs {...breadcrumbProps} />\n      </EditorRootBreadcrumbsRoot>\n    );\n  }\n}\n","import { Controller, FocusMode, Model } from '@blink-mind/core';\nimport { HotKeysConfig } from '@blink-mind/renderer-react';\nimport { Hotkey, Hotkeys, HotkeysTarget } from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { DragScrollWidget } from '../../../components/common';\nimport { EventKey, RefKey, topicRefKey } from '../../../utils';\nconst NodeLayer = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n`;\n\nconst DIV = styled.div`\n  width: 100%;\n  height: 100%;\n  background: ${props => props.theme.background};\n`;\n\nexport interface MindDragScrollWidgetProps {\n  controller: Controller;\n  model: Model;\n  saveRef?: Function;\n  getRef?: Function;\n}\n\n@HotkeysTarget\nexport class MindDragScrollWidget<\n  P extends MindDragScrollWidgetProps\n> extends React.Component<MindDragScrollWidgetProps> {\n  constructor(props: MindDragScrollWidgetProps) {\n    super(props);\n  }\n\n  renderHotkeys() {\n    const props = this.props;\n    const { controller, model } = props;\n    const hotKeys: HotKeysConfig = controller.run('customizeHotKeys', props);\n    if (hotKeys === null) return null;\n    if (\n      !(\n        hotKeys.topicHotKeys instanceof Map &&\n        hotKeys.globalHotKeys instanceof Map\n      )\n    ) {\n      throw new TypeError('topicHotKeys and globalHotKeys must be a Map');\n    }\n    const children = [];\n    if (\n      model.focusMode === FocusMode.NORMAL ||\n      model.focusMode === FocusMode.SHOW_POPUP\n    ) {\n      hotKeys.topicHotKeys.forEach((v, k) => {\n        children.push(<Hotkey key={k} {...v} global />);\n      });\n    }\n    hotKeys.globalHotKeys.forEach((v, k) => {\n      children.push(<Hotkey key={k} {...v} global />);\n    });\n    return <Hotkeys>{children}</Hotkeys>;\n  }\n\n  componentDidMount(): void {\n    const { getRef, model, controller } = this.props;\n    controller.run('addZoomFactorChangeEventListener', {\n      ...this.props,\n      listener: this.setZoomFactor\n    });\n    const rootTopic: HTMLElement = getRef(\n      topicRefKey(model.editorRootTopicKey)\n    );\n    //TODO\n    const nodeLayer: HTMLElement = getRef('node-layer');\n    const rootTopicRect = rootTopic.getBoundingClientRect();\n    const nodeLayerRect = nodeLayer.getBoundingClientRect();\n    this.dragScrollWidget.setViewBoxScrollDelta(\n      0,\n      rootTopicRect.top -\n        nodeLayerRect.top -\n        this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 +\n        rootTopicRect.height\n    );\n    this.layout();\n  }\n\n  componentWillUnmount(): void {\n    const { controller } = this.props;\n    controller.run('removeZoomFactorChangeEventListener', {\n      ...this.props,\n      listener: this.setZoomFactor\n    });\n  }\n\n  get dragScrollWidget(): DragScrollWidget {\n    return this.props.getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n  }\n\n  componentDidUpdate(): void {\n    const { controller } = this.props;\n    controller.run('fireEvent', {\n      ...this.props,\n      key: EventKey.CENTER_ROOT_TOPIC\n    });\n    this.layout();\n  }\n\n  layout() {\n    const { controller } = this.props;\n    controller.run('layout', this.props);\n  }\n\n  setZoomFactor = zoomFactor => {\n    this.dragScrollWidget.setZoomFactor(zoomFactor);\n  };\n\n  onWheel = e => {\n    if (e.altKey || e.ctrlKey) {\n      const { controller } = this.props;\n      let zoomFactor = controller.run('getZoomFactor', this.props);\n      zoomFactor = zoomFactor - (e.nativeEvent.deltaY > 0 ? 0.1 : -0.1);\n      if (zoomFactor < 0.5) zoomFactor = 0.5;\n      if (zoomFactor > 4) zoomFactor = 4;\n      // console.log('zoomFactor=>', zoomFactor);\n      controller.run('setZoomFactor', { ...this.props, zoomFactor });\n    }\n  };\n\n  render() {\n    const { saveRef, model, controller } = this.props;\n    const nodeKey = model.editorRootTopicKey;\n    return (\n      <DIV onWheel={this.onWheel}>\n        <DragScrollWidget\n          {...this.state}\n          enableMouseWheel={false}\n          zoomFactor={model.zoomFactor}\n          ref={saveRef(RefKey.DRAG_SCROLL_WIDGET_KEY)}\n        >\n          {(\n            setViewBoxScroll: (left: number, top: number) => void,\n            setViewBoxScrollDelta: (left: number, top: number) => void\n          ) => {\n            const rootWidgetProps = {\n              ...this.props,\n              topicKey: nodeKey,\n              setViewBoxScroll,\n              setViewBoxScrollDelta\n            };\n            return (\n              <NodeLayer ref={saveRef('node-layer')}>\n                {controller.run('renderRootWidget', rootWidgetProps)}\n              </NodeLayer>\n            );\n          }}\n        </DragScrollWidget>\n      </DIV>\n    );\n  }\n}\n","import { Classes, Dialog } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\n\ninterface Props extends BaseProps {\n  saveRef?: Function;\n}\n\nexport class Modals extends BaseWidget<Props> {\n  handleClose = () => {\n    const { controller } = this.props;\n    const handleActiveModalClose = controller.run(\n      'handleActiveModalClose',\n      this.props\n    );\n\n    handleActiveModalClose && handleActiveModalClose();\n  };\n\n  render() {\n    const { controller } = this.props;\n    const activeModal = controller.run('renderModal', this.props);\n    const activeModalProps = controller.run('getActiveModalProps', this.props);\n    return (\n      <Dialog\n        onClose={this.handleClose}\n        isOpen={activeModal !== null}\n        autoFocus\n        enforceFocus\n        usePortal\n        title={activeModalProps && activeModalProps.title}\n        style={activeModalProps && activeModalProps.style}\n      >\n        <div className={Classes.DIALOG_BODY} style={{ minHeight: 0 }}>\n          {activeModal}\n        </div>\n      </Dialog>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  centerPointX,\n  centerPointY,\n  centerX,\n  centerY,\n  getRelativeRect,\n  Point,\n  RefKey\n} from '../../../utils';\n\nimport debug from 'debug';\nimport { contentRefKey, linksSvgRefKey } from '../../../utils';\nconst RootLinksSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n`;\n\nconst log = debug('node:root-sub-links');\n\ninterface Props extends BaseProps {}\n\ninterface State {\n  curves: any[];\n}\n\nexport class RootSubLinks extends BaseWidget<Props, State> {\n  state = {\n    curves: []\n  };\n\n  layout() {\n    const props = this.props;\n    const { model, getRef, topicKey, zoomFactor, controller } = props;\n    const topic = model.getTopic(topicKey);\n    const content = getRef(contentRefKey(topicKey));\n    const svg = getRef(linksSvgRefKey(topicKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const contentRect = getRelativeRect(content, bigView, zoomFactor);\n    const svgRect = getRelativeRect(svg, bigView, zoomFactor);\n    let p1: Point, p2: Point;\n\n    p1 = {\n      x: centerX(contentRect) - svgRect.left,\n      y: centerY(contentRect) - svgRect.top\n    };\n    const curves = [];\n    topic.subKeys.forEach(key => {\n      const linkStyle = controller.run('getLinkStyle', {\n        ...props,\n        topicKey: key\n      });\n      const lineType = linkStyle.lineType;\n      const subTopicContent = getRef(contentRefKey(key));\n      const rect = getRelativeRect(subTopicContent, bigView, zoomFactor);\n      if (rect.left > contentRect.right) {\n        p2 = {\n          x: rect.left,\n          y: centerY(rect)\n        };\n      } else {\n        p2 = {\n          x: rect.right,\n          y: centerY(rect)\n        };\n      }\n      p2 = { x: p2.x - svgRect.left, y: p2.y - svgRect.top };\n      let curve;\n      if (lineType === 'curve') {\n        curve = `M ${p1.x} ${p1.y} C ${p1.x} ${centerPointY(\n          p1,\n          p2\n        )} ${centerPointX(p1, p2)} ${p2.y} ${p2.x} ${p2.y}`;\n      } else if (lineType === 'line') {\n        curve = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`;\n      } else if (lineType === 'round') {\n        const vDir = p2.y > p1.y ? 1 : -1;\n        const hDir = p2.x > p1.x ? 1 : -1;\n        const radius = linkStyle.lineRadius;\n        if (radius == null) {\n          throw new Error(\n            'link line type is round, but lineRadius is not provided!'\n          );\n        }\n        if (p2.y === p1.y) {\n          curve = `M ${p1.x} ${p1.y} H ${p2.x}`;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = `M ${p1.x} ${p1.y}  V ${p2.y -\n            vDir * radius} A ${radius} ${radius} 0 0 ${\n            vDir * hDir === 1 ? 0 : 1\n          } ${p1.x + radius * hDir} ${p2.y} H ${p2.x}`;\n        }\n      }\n      curves.push(\n        <path\n          key={`link-${key}`}\n          d={curve}\n          strokeWidth={linkStyle.lineWidth}\n          stroke={linkStyle.lineColor}\n          fill=\"none\"\n        />\n      );\n    });\n    this.setState({\n      curves\n    });\n  }\n\n  render() {\n    log('render');\n    const { topicKey, saveRef } = this.props;\n    return (\n      <RootLinksSvg ref={saveRef(linksSvgRefKey(topicKey))}>\n        <g>{this.state.curves}</g>\n      </RootLinksSvg>\n    );\n  }\n}\n","import { DiagramLayoutType, KeyType, TopicDirection } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { topicRefKey } from '../../../utils';\n\nconst log = debug('RootNode');\n\nconst LayerPart = styled.div`\n  display: flex;\n  position: relative;\n\n  align-items: ${props =>\n    //@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start'};\n  flex-direction: column;\n\n  padding: ${props =>\n    //@ts-ignore\n    props.topicDirection === TopicDirection.LEFT\n      ? '15px 60px 15px 0px'\n      : '15px 0px 15px 60px'};\n`;\n\nconst Topic = styled.div`\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n`;\n\ninterface Props extends BaseProps {\n  setViewBoxScroll?: (left: number, top: number) => void;\n  setViewBoxScrollDelta?: (left: number, top: number) => void;\n}\n\nexport class RootWidget extends React.Component<Props> {\n  renderPartTopics(topics: KeyType[], dir: string) {\n    const { controller, saveRef } = this.props;\n    const res = controller.run('createSubTopics', {\n      ...this.props,\n      dir,\n      isRoot: true,\n      topics\n    });\n    if (!res) return null;\n    const { subTopics } = res;\n    const cxName = `bm-layer-${dir === TopicDirection.LEFT ? 'left' : 'right'}`;\n    return (\n      //@ts-ignore\n      <LayerPart topicDirection={dir} ref={saveRef(cxName)}>\n        {subTopics}\n      </LayerPart>\n    );\n  }\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { model, topicKey, saveRef, controller } = props;\n    const topicStyle = controller.run('getTopicContentStyle', props);\n    const config = model.config;\n    const topicContent = controller.run('renderTopicContent', {\n      ...props,\n      topicStyle,\n      dir: TopicDirection.MAIN\n    });\n    const partTopics = controller.run('getPartTopics', {\n      layout: config.layoutDir,\n      model,\n      topicKey\n    });\n    const rootTopic = (\n      <Topic ref={saveRef(topicRefKey(topicKey))}>{topicContent}</Topic>\n    );\n    const children = controller.run('renderRootWidgetOtherChildren', props);\n    switch (config.layoutDir) {\n      case DiagramLayoutType.LEFT_AND_RIGHT:\n        return (\n          <>\n            {this.renderPartTopics(partTopics.L, 'L')}\n            {rootTopic}\n            {this.renderPartTopics(partTopics.R, 'R')}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.LEFT_TO_RIGHT:\n        return (\n          <>\n            {rootTopic}\n            {this.renderPartTopics(partTopics.R, 'R')}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.RIGHT_TO_LEFT:\n        return (\n          <>\n            {this.renderPartTopics(partTopics.L, 'L')}\n            {rootTopic}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.TOP_TO_BOTTOM:\n        return (\n          <>\n            {rootTopic}\n            {this.renderPartTopics(partTopics.B, 'B')}\n            {children}\n          </>\n        );\n    }\n    return null;\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport cx from 'classnames';\nimport * as React from 'react';\nimport styled, { css } from 'styled-components';\nimport { collapseRefKey } from '../../../utils';\n\nconst Icon = styled.div`\n  position: absolute;\n  top: calc(50% - 10px);\n  ${({ dir }) => {\n    if (dir === TopicDirection.RIGHT)\n      return css`\n        right: -25px;\n      `;\n    if (dir === TopicDirection.LEFT)\n      return css`\n        left: -25px;\n      `;\n  }};\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ${props => props.background};\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n`;\n\nexport function TopicCollapseIcon(props) {\n  const { model, topicKey, topicStyle, dir, saveRef, onClickCollapse } = props;\n  const topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? (\n    <Icon\n      ref={saveRef(collapseRefKey(topicKey))}\n      onClick={onClickCollapse}\n      background={topicStyle.background}\n      dir={dir}\n      className={cx({\n        icon: true,\n        iconfont: true,\n        [`bm-${topic.collapse ? 'plus' : 'minus'}`]: true\n      })}\n    />\n  ) : null;\n}\n","import debug from 'debug';\nimport * as React from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled from 'styled-components';\nconst log = debug('node:topic-content2');\n\nconst EditingRoot = styled.div`\n  position: relative;\n`;\n\nconst EditingWrapper = styled.div`\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n`;\nconst cancelEvent = e => {\n  log('cancelEvent');\n  e.preventDefault();\n  e.stopPropagation();\n};\nexport function TopicContent(props) {\n  const { controller, model, topicKey, getRef } = props;\n  const readOnly = model.editingContentKey !== topicKey;\n  const editor = controller.run('renderTopicContentEditor', {\n    ...props,\n    readOnly\n  });\n  let child;\n  if (readOnly) {\n    child = editor;\n  } else {\n    let wrapper;\n    const wrapperRef = ref => {\n      if (ref) {\n        wrapper = ref;\n        contentResizeObserver.observe(wrapper);\n      }\n    };\n    let rect = { width: 50, height: 40 };\n    const editorDiv = getRef(`content-editor-${topicKey}`);\n    if (editorDiv) rect = editorDiv.getBoundingClientRect();\n    const contentResizeCallback = (\n      entries: ResizeObserverEntry[],\n      observer: ResizeObserver\n    ) => {\n      const r = entries[0].contentRect;\n      wrapper.style.left = (rect.width - r.width) / 2 + 'px';\n      wrapper.style.top = (rect.height - r.height) / 2 + 'px';\n    };\n    const contentResizeObserver = new ResizeObserver(contentResizeCallback);\n    log(rect);\n    child = (\n      <>\n        <div style={{ width: rect.width, height: rect.height }}></div>\n        {/*<Dialog isOpen>{editor}</Dialog>*/}\n        <EditingWrapper ref={wrapperRef}>{editor}</EditingWrapper>\n      </>\n    );\n  }\n  return (\n    <EditingRoot onDragEnter={cancelEvent} onDragOver={cancelEvent}>\n      {child}\n    </EditingRoot>\n  );\n}\n","import { FocusMode, OpType, TopicDirection } from '@blink-mind/core';\nimport { ContextMenuTarget } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { collapseRefKey, contentRefKey, PropKey } from '../../../utils';\n\nconst log = debug('node:topic-content-widget');\n\ninterface TopicContentProps {\n  dragEnter?: boolean;\n}\n\nconst TopicContent = styled.div<TopicContentProps>`\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n`;\n\nconst TopicContentWithDropArea = styled.div`\n  position: relative;\n`;\n\ninterface Props extends BaseProps {\n  draggable: boolean;\n}\n\ninterface State {\n  dragEnter: boolean;\n}\n\n@ContextMenuTarget\nexport class TopicContentWidget extends BaseWidget<Props, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dragEnter: false\n    };\n  }\n\n  onDragStart = ev => {\n    this.run('handleTopicDragStart', { ...this.props, ev });\n  };\n\n  onDragOver = ev => {\n    // log('onDragOver');\n    ev.preventDefault();\n  };\n\n  onDragEnter = ev => {\n    log('onDragEnter', this.props.topicKey);\n    this.run('handleTopicDragEnter', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  onDragLeave = ev => {\n    this.run('handleTopicDragLeave', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  onDrop = ev => {\n    log('onDrop');\n    this.run('handleTopicDrop', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  public renderContextMenu() {\n    const { controller } = this.props;\n    if (\n      !controller.getValue(PropKey.TOPIC_CONTEXT_MENU_ENABLED, {\n        ...this.props\n      })\n    ) {\n      return;\n    }\n    this.operation(OpType.FOCUS_TOPIC, {\n      ...this.props,\n      focusMode: FocusMode.SHOW_POPUP\n    });\n    return controller.run('renderTopicContextMenu', this.props);\n  }\n\n  public onContextMenuClose() {\n    // Optional method called once the context menu is closed.\n  }\n\n  handleTopicClickTimeout;\n\n  onClick = ev => {\n    const props = this.props;\n    const { controller } = props;\n    //TODO bug [Violation] 'setTimeout' handler took 69ms\n    this.handleTopicClickTimeout = setTimeout(() => {\n      // log('handleTopicClick');\n      //注意这里要传递this.props, 而不是props, 因为会先调用onClick, 再调用其他的topic-content-editor的onClickOutside\n      //其他组件的onClickOutside是个同步的函数,会设置新的model, 如果这里用props传参,会导致model 还是老的model\n      controller.run('handleTopicClick', { ...this.props, ev });\n    }, 200);\n  };\n\n  onDoubleClick = ev => {\n    clearTimeout(this.handleTopicClickTimeout);\n    const { controller } = this.props;\n    controller.run('handleTopicDoubleClick', { ...this.props, ev });\n  };\n\n  needRelocation: boolean = false;\n  oldCollapseIconVector;\n\n  componentDidUpdate() {\n    if (this.needRelocation) {\n      const { getRef, topicKey, setViewBoxScrollDelta } = this.props;\n      const newIcon = getRef(collapseRefKey(topicKey));\n      const newRect = newIcon.getBoundingClientRect();\n      // const newVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: getRef(collapseRefKey(topicKey))\n      // });\n      const newVector = [\n        newRect.left + newRect.width / 2,\n        newRect.top + newRect.height / 2\n      ];\n      log('newVector:', newVector);\n      log('oldVector:', this.oldCollapseIconVector);\n      //TODO bug\n      const vector = [\n        newVector[0] - this.oldCollapseIconVector[0],\n        newVector[1] - this.oldCollapseIconVector[1]\n      ];\n      log('vector', vector);\n      setViewBoxScrollDelta(vector[0], vector[1]);\n      this.needRelocation = false;\n    }\n  }\n\n  onClickCollapse = e => {\n    e.stopPropagation();\n    const { topicKey, getRef } = this.props;\n    this.needRelocation = true;\n    const collapseIcon = getRef(collapseRefKey(topicKey));\n    const rect = collapseIcon.getBoundingClientRect();\n    log('oldRect', rect);\n    this.oldCollapseIconVector = [\n      rect.left + rect.width / 2,\n      rect.top + rect.height / 2\n    ];\n    log('oldCollapseIconVector', this.oldCollapseIconVector);\n    // this.oldCollapseIconVector = controller.run('getRelativeVectorFromViewPort', {\n    //   ...this.props,\n    //   element: collapseIcon\n    // });\n    this.operation(OpType.TOGGLE_COLLAPSE, this.props);\n  };\n\n  render() {\n    const props = this.props;\n    const { saveRef, topicKey, model, controller, topicStyle, dir } = props;\n    log('render', topicKey, model.focusMode);\n    const draggable =\n      controller.run('isOperationEnabled', props) &&\n      model.editingContentKey !== topicKey;\n    const collapseIcon = controller.run('renderTopicCollapseIcon', {\n      ...props,\n      onClickCollapse: this.onClickCollapse.bind(this)\n    });\n    const prevDropArea = controller.run('renderTopicDropArea', {\n      ...props,\n      dropDir: 'prev'\n    });\n    const nextDropArea = controller.run('renderTopicDropArea', {\n      ...props,\n      dropDir: 'next'\n    });\n    const dropEventHandlers = {\n      onDragEnter: this.onDragEnter,\n      onDragLeave: this.onDragLeave,\n      onDragOver: this.onDragOver,\n      onDrop: this.onDrop\n    };\n    // log(topicKey, 'style', topicStyle);\n    return (\n      <TopicContentWithDropArea>\n        {prevDropArea}\n        <TopicContent\n          style={topicStyle}\n          draggable={draggable}\n          ref={saveRef(contentRefKey(topicKey))}\n          onDragStart={this.onDragStart}\n          onClick={this.onClick}\n          onDoubleClick={this.onDoubleClick}\n          {...dropEventHandlers}\n        >\n          {controller.run('renderTopicBlocks', props)}\n          {controller.run('renderTopicContentOthers', props)}\n        </TopicContent>\n        {nextDropArea}\n        {dir !== TopicDirection.MAIN && collapseIcon}\n      </TopicContentWithDropArea>\n    );\n  }\n}\n","import { BlockType, OpType } from '@blink-mind/core';\nimport { Classes, Popover, PopoverInteractionKind } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { TopicBlockIcon } from '../../../components/common/styled';\nimport { cancelEvent, iconClassName, IconName, RefKey } from '../../../utils';\n\nconst log = debug('node:topic-desc');\n\nconst TooltipContentWrapper = styled.div`\n  overflow: auto;\n`;\n\nexport function TopicDesc(props) {\n  const { controller, model, topicKey, getRef } = props;\n  const isEditing = model.editingDescKey === topicKey;\n  log('isEditing', isEditing);\n  const onClick = e => {\n    e.stopPropagation();\n    controller.run('operation', {\n      ...props,\n      opType: OpType.START_EDITING_DESC\n    });\n  };\n\n  const desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  if (\n    !isEditing &&\n    controller.run('isBlockEmpty', { ...props, block: desc.block })\n  )\n    return null;\n  const descEditor = controller.run('renderTopicDescEditor', props);\n  const diagramRoot = getRef(RefKey.DIAGRAM_ROOT_KEY);\n  const style = {\n    maxWidth: '800px',\n    maxHeight: '600px'\n  };\n  if (diagramRoot) {\n    const dRect = diagramRoot.getBoundingClientRect();\n    style.maxWidth = `${dRect.width * 0.6}px`;\n    style.maxHeight = `${dRect.height * 0.8}px`;\n  }\n  const tooltipContent = (\n    <TooltipContentWrapper\n      onClick={cancelEvent}\n      classname={Classes.POPOVER_DISMISS}\n      style={style}\n    >\n      {descEditor}\n    </TooltipContentWrapper>\n  );\n  const icon = (\n    <TopicBlockIcon\n      onClick={onClick}\n      className={iconClassName(IconName.NOTES)}\n      tabIndex={-1}\n    />\n  );\n  const tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.HOVER,\n    hoverOpenDelay: 500\n  };\n\n  const descIcon = desc.block && <Popover {...tooltipProps}></Popover>;\n  return descIcon;\n}\n","import { FocusMode } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { contentRefKey, getRelativeRect, RefKey } from '../../../utils';\n\nconst FocusHighlightSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n`;\n\ninterface State {\n  content: any;\n}\n\nexport class TopicHighlight extends BaseWidget<BaseProps, State> {\n  state = {\n    content: null\n  };\n\n  layout() {\n    const { getRef, model, zoomFactor } = this.props;\n    const focusKey = model.focusKey;\n    const focusMode = model.focusMode;\n    if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n    const content = getRef(contentRefKey(focusKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const svg = getRef(RefKey.SVG_HIGHLIGHT_KEY);\n    const contentRect = getRelativeRect(content, bigView, zoomFactor);\n    const svgRect = getRelativeRect(svg, bigView, zoomFactor);\n    const padding = 3;\n    const x = contentRect.left - svgRect.left - padding;\n    const y = contentRect.top - svgRect.top - padding;\n    const width = contentRect.width + 2 * padding;\n    const height = contentRect.height + 2 * padding;\n    this.setState({\n      content: (\n        <rect\n          x={x}\n          y={y}\n          width={width}\n          height={height}\n          fill=\"none\"\n          stroke={model.config.theme.highlightColor}\n          strokeWidth={2}\n        />\n      )\n    });\n  }\n\n  render() {\n    const { saveRef } = this.props;\n    return (\n      <FocusHighlightSvg ref={saveRef(RefKey.SVG_HIGHLIGHT_KEY)}>\n        {this.state.content}\n      </FocusHighlightSvg>\n    );\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  centerPointX,\n  centerPointY,\n  centerY,\n  collapseRefKey,\n  contentRefKey,\n  getRelativeRect,\n  linksSvgRefKey,\n  Point,\n  RefKey\n} from '../../../utils';\n\nconst TopicLinksSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n`;\nimport debug from 'debug';\nconst log = debug('node:topic-sub-links');\n\ninterface Props extends BaseProps {}\n\ninterface State {\n  curves: any[];\n}\n\nexport class TopicSubLinks extends BaseWidget<Props, State> {\n  state = {\n    curves: []\n  };\n  layout() {\n    const props = this.props;\n    const { model, getRef, topicKey, dir, controller } = props;\n    const z = controller.run('getZoomFactor', props);\n    const topic = model.getTopic(topicKey);\n    const content = getRef(contentRefKey(topicKey));\n    const svg = getRef(linksSvgRefKey(topicKey));\n    const collapseIcon = getRef(collapseRefKey(topicKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const svgRect = getRelativeRect(svg, bigView, z);\n    const collapseRect = getRelativeRect(collapseIcon, bigView, z);\n    const contentRect = getRelativeRect(content, bigView, z);\n    log(topicKey);\n    log('svgRect', svgRect);\n    log('collapseRect', collapseRect);\n    log('contentRect', contentRect);\n    let p1: Point, p2: Point, p3: Point;\n\n    if (dir === TopicDirection.RIGHT) {\n      p1 = {\n        x: 0,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.right - svgRect.left + 10,\n        y: p1.y\n      };\n    } else if (dir === TopicDirection.LEFT) {\n      p1 = {\n        x: svgRect.right - svgRect.left,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.left - svgRect.left - 10,\n        y: p1.y\n      };\n    }\n    const curves = [];\n\n    topic.subKeys.forEach(key => {\n      let curve;\n      const linkStyle = controller.run('getLinkStyle', {\n        ...props,\n        topicKey: key\n      });\n      // log(key);\n      const subContent = getRef(contentRefKey(key));\n      if (!subContent) return;\n      const rect = getRelativeRect(subContent, bigView, z);\n\n      if (dir === TopicDirection.RIGHT) {\n        p3 = {\n          x: rect.left - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n      if (dir === TopicDirection.LEFT) {\n        p3 = {\n          x: rect.right - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n      const { lineType } = linkStyle;\n\n      if (lineType === 'curve') {\n        curve = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y} C ${p2.x} ${centerPointY(\n          p2,\n          p3\n        )} ${centerPointX(p2, p3)} ${p3.y} ${p3.x} ${p3.y}`;\n      } else if (lineType === 'round') {\n        const vDir = p3.y > p1.y ? 1 : -1;\n        const hDir = p3.x > p1.x ? 1 : -1;\n        const radius = linkStyle.lineRadius;\n        // if (p3.y === p1.y) { //这样判断不可靠\n        if (topic.subKeys.size === 1 || Math.abs(p3.y - p1.y) <= 1) {\n          curve = `M ${p1.x} ${p1.y} L ${p3.x} ${p3.y}`;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = `M ${p1.x} ${p1.y} H ${p2.x} V ${p3.y -\n            vDir * radius} A ${radius} ${radius} 0 0 ${\n            vDir * hDir === 1 ? 0 : 1\n          } ${p2.x + radius * hDir} ${p3.y} H ${p3.x}`;\n        }\n      } else if (lineType === 'line') {\n        curve = `M ${p1.x} ${p1.y} H ${p2.x} L ${p3.x} ${p3.y}`;\n      }\n\n      curves.push(\n        <path\n          key={`link-${key}`}\n          d={curve}\n          strokeWidth={linkStyle.lineWidth}\n          stroke={linkStyle.lineColor}\n          fill=\"none\"\n        />\n      );\n    });\n    this.setState({\n      curves\n    });\n  }\n\n  render() {\n    const { topicKey, saveRef } = this.props;\n    return (\n      <TopicLinksSvg ref={saveRef(linksSvgRefKey(topicKey))}>\n        <g>{this.state.curves}</g>\n      </TopicLinksSvg>\n    );\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { linksRefKey, topicRefKey } from '../../../utils';\nimport { TopicSubLinks } from './topic-sub-links';\n\nconst log = debug('node:topic-widget');\n\ntype NodeProps = {\n  topicDirection: string;\n};\n\nconst Node = styled.div<NodeProps>`\n  display: flex;\n  align-items: center;\n  flex-direction: ${props =>\n    props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse'};\n`;\n\ninterface NodeChildrenProps {\n  dir: string;\n  marginH: number;\n}\n\n// TODO\nconst NodeChildren = styled.div<NodeChildrenProps>`\n  position: relative;\n  padding: ${props =>\n    props.dir === TopicDirection.RIGHT\n      ? `0 0 0 ${props.marginH}px`\n      : `0 ${props.marginH}px 0 0`};\n`;\n\ninterface NodeTopicProps {\n  topicDirection: string;\n}\n\nconst NodeTopic = styled.div<NodeTopicProps>`\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ${props =>\n    props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse'};\n`;\n\ninterface Props extends BaseProps {\n  setViewBoxScroll?: (left: number, top: number) => void;\n  setViewBoxScrollDelta?: (left: number, top: number) => void;\n}\n\nexport class TopicWidget extends React.Component<Props> {\n  renderSubTopics() {\n    const props = this.props;\n    const { controller, model, topicKey, dir } = props;\n    const topics = model.getTopic(topicKey).subKeys.toArray();\n    const res = controller.run('createSubTopics', { ...props, topics });\n    if (!res) return null;\n    const { subTopics } = res;\n    const subLinks = controller.run('renderSubLinks', props);\n    return (\n      <NodeChildren dir={dir} marginH={model.config.theme.marginH}>\n        {subTopics} {subLinks}\n      </NodeChildren>\n    );\n  }\n\n  // componentDidUpdate(): void {\n  //   this.layoutLinks();\n  // }\n  //\n  // componentDidMount(): void {\n  //   this.layoutLinks();\n  // }\n\n  layoutLinks() {\n    const { getRef, topicKey, model } = this.props;\n    const topic = model.getTopic(topicKey);\n    if (topic.subKeys.size === 0 || topic.collapse) return;\n    log('layoutLinks', topicKey);\n    const links: TopicSubLinks = getRef(linksRefKey(topicKey));\n    links && links.layout();\n  }\n\n  render() {\n    const props = this.props;\n    const { controller, topicKey, dir, saveRef } = props;\n    log('render', topicKey);\n    const topicStyle = controller.run('getTopicContentStyle', props);\n    const propsMore = {\n      ...props,\n      topicStyle\n    };\n    const topicContent = controller.run('renderTopicContent', propsMore);\n\n    return (\n      <Node topicDirection={dir}>\n        <NodeTopic topicDirection={dir} ref={saveRef(topicRefKey(topicKey))}>\n          {topicContent}\n        </NodeTopic>\n        {this.renderSubTopics()}\n      </Node>\n    );\n  }\n}\n","import { OpType } from '@blink-mind/core';\nimport { Classes, Position, Tooltip } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget, Btn, ZIndex } from '../../../../components/common';\nimport { EventKey, Icon, IconName } from '../../../../utils';\n\nconst log = debug('node:view-port-viewer');\n\nconst ViewerRoot = styled(ZIndex)`\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n`;\n\nconst Item_ = styled(Btn)`\n  margin: 10px;\n`;\n\nconst ZoomFactorSpan = styled.span`\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n`;\n\nconst Item = props => {\n  return (\n    <Tooltip\n      content={props.tooltip}\n      position={Position.TOP}\n      className={Classes.ICON}\n    >\n      <Item_ onClick={props.onClick} tabIndex={-1}>\n        {props.children}\n      </Item_>\n    </Tooltip>\n  );\n};\n\nexport class ViewPortViewer extends BaseWidget {\n  constructor(props) {\n    super(props);\n  }\n\n  componentDidMount(): void {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addZoomFactorChangeEventListener', {\n      ...props,\n      listener: this.zoomFactorChange\n    });\n  }\n\n  componentWillUnmount(): void {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('removeZoomFactorChangeEventListener', {\n      ...props,\n      listener: this.zoomFactorChange\n    });\n  }\n\n  zoomFactorChange = zoomFactor => {\n    log('zoomFactorChange', zoomFactor);\n    this.setState({ zoomFactor });\n  };\n\n  onClickResetZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: 1\n    });\n  };\n\n  onClickAddZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: zoomFactor + 0.1\n    });\n  };\n\n  onClickMinusZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: zoomFactor - 0.1\n    });\n  };\n\n  onClickCollapseAll = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addEventListener', {\n      ...props,\n      key: EventKey.CENTER_ROOT_TOPIC,\n      listener: this.centerRootTopic,\n      once: true\n    });\n    controller.run('operation', {\n      ...props,\n      opType: OpType.COLLAPSE_ALL\n    });\n  };\n\n  onClickExpandAll = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addEventListener', {\n      ...props,\n      key: EventKey.CENTER_ROOT_TOPIC,\n      listener: this.centerRootTopic,\n      once: true\n    });\n    controller.run('operation', {\n      ...props,\n      opType: OpType.EXPAND_ALL\n    });\n  };\n\n  centerRootTopic = () => {\n    const { model, controller } = this.props;\n    controller.run('moveTopicToCenter', {\n      ...this.props,\n      topicKey: model.editorRootTopicKey\n    });\n  };\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { controller, zIndex } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    return (\n      <ViewerRoot zIndex={zIndex}>\n        <Item onClick={this.onClickCollapseAll} tooltip=\"collapse all\">\n          {Icon(IconName.COLLAPSE_ALL)}\n        </Item>\n        <Item onClick={this.onClickExpandAll} tooltip=\"expand all\">\n          {Icon(IconName.EXPAND_ALL)}\n        </Item>\n        <Item onClick={this.centerRootTopic} tooltip=\"center root topic\">\n          {Icon(IconName.CENTER)}\n        </Item>\n        <Item onClick={this.onClickMinusZoom} tooltip=\"zoom in\">\n          {Icon(IconName.MINUS)}\n        </Item>\n        <Item onClick={this.onClickResetZoom} tooltip=\"reset zoom\">\n          <ZoomFactorSpan>{`zoom:${Math.floor(\n            zoomFactor * 100\n          )}%`}</ZoomFactorSpan>\n        </Item>\n        <Item onClick={this.onClickAddZoom} tooltip=\"zoom out\">\n          {Icon(IconName.PLUS)}\n        </Item>\n      </ViewerRoot>\n    );\n  }\n}\n","import { BlockType, FocusMode, OpType } from '@blink-mind/core';\nimport { Drawer } from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { cancelEvent, Icon } from '../../utils';\nconst DescEditorWrapper = styled.div`\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n`;\n\nexport function renderDrawer(props) {\n  const { controller, model, topicKey } = props;\n  if (model.focusMode === FocusMode.EDITING_DESC) {\n    const onDescEditorClose = e => {\n      e.stopPropagation();\n      const key = `topic-desc-data-${topicKey}`;\n      const descData = controller.run('deleteTempValue', { key });\n      controller.run('operation', {\n        ...props,\n        opType: OpType.SET_TOPIC_BLOCK,\n        topicKey,\n        blockType: BlockType.DESC,\n        data: descData,\n        focusMode: FocusMode.NORMAL\n      });\n    };\n    const descEditor = controller.run('renderTopicDescEditor', props);\n    return (\n      <Drawer\n        key=\"drawer\"\n        title=\"Edit Notes\"\n        icon={Icon('note')}\n        isOpen\n        hasBackdrop\n        backdropProps={{ onMouseDown: cancelEvent }}\n        isCloseButtonShown={false}\n        onClose={onDescEditorClose}\n        size=\"70%\"\n      >\n        <DescEditorWrapper>{descEditor}</DescEditorWrapper>\n      </Drawer>\n    );\n  }\n}\n","import * as React from 'react';\nimport { ThemeProvider } from 'styled-components';\n\n//TODO 是否需要themeProvider\nexport default function Theme({ theme, children }) {\n  return (\n    //@ts-ignore\n    <ThemeProvider theme={theme}>\n      <React.Fragment>{children}</React.Fragment>\n    </ThemeProvider>\n  );\n}\n","import { BlockType } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { SaveRef } from '../../components/common';\nimport { linksRefKey, PropKey, RefKey } from '../../utils';\nimport { EditorRootBreadcrumbs } from './components/editor-root-breadcrumbs';\nimport { MindDragScrollWidget } from './components/mind-drag-scroll-widget';\nimport { Modals } from './components/modals';\nimport { RootSubLinks } from './components/root-sublinks';\nimport { RootWidget } from './components/root-widget';\nimport { TopicCollapseIcon } from './components/topic-collapse-icon';\nimport { TopicContent } from './components/topic-content';\nimport { TopicContentWidget } from './components/topic-content-widget';\nimport { TopicDesc } from './components/topic-desc';\nimport { TopicHighlight } from './components/topic-highlight';\nimport { TopicSubLinks } from './components/topic-sub-links';\nimport { TopicWidget } from './components/topic-widget';\nimport { ViewPortViewer } from './components/view-port-util';\nimport { renderDrawer } from './drawer';\nimport Theme from './theme';\nconst log = debug('plugin:rendering');\n\nexport function RenderingPlugin() {\n  const DiagramRoot = styled.div`\n    width: 100%;\n    height: 100%;\n    background: ${props => props.theme.background};\n    position: relative;\n  `;\n  let diagramProps;\n  return {\n    getDiagramProps() {\n      return diagramProps;\n    },\n    renderDiagram(props) {\n      const { model, controller } = props;\n      return (\n        <SaveRef>\n          {(saveRef, getRef, deleteRef) => {\n            diagramProps = {\n              ...props,\n              saveRef,\n              getRef,\n              deleteRef\n            };\n\n            log('renderDiagram', model);\n            return (\n              <Theme theme={model.config.theme}>\n                <DiagramRoot ref={saveRef(RefKey.DIAGRAM_ROOT_KEY)}>\n                  <MindDragScrollWidget {...diagramProps} />\n                  {controller.run('renderDiagramCustomize', diagramProps)}\n                </DiagramRoot>\n              </Theme>\n            );\n          }}\n        </SaveRef>\n      );\n    },\n    renderDrawer,\n\n    renderDiagramCustomize(props) {\n      const { controller, model } = props;\n      const zIndex = controller.getValue(\n        PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX\n      );\n      const nProps = {\n        ...props,\n        zIndex,\n        topicKey: model.focusKey\n      };\n      const breadcrumbs = controller.run('renderEditorRootBreadcrumbs', nProps);\n      // const styleEditor = controller.run('renderStyleEditor', nProps);\n      const rightTopPanel = controller.run('renderRightTopPanel', nProps);\n      const modals = controller.run('renderModals', {\n        ...nProps,\n        zIndex: zIndex + 1\n      });\n      const drawer = controller.run('renderDrawer', {\n        ...nProps,\n        zIndex: zIndex + 1\n      });\n      const viewportViewer = controller.run('renderViewPortViewer', nProps);\n      return [breadcrumbs, rightTopPanel, modals, drawer, viewportViewer];\n    },\n\n    renderEditorRootBreadcrumbs(props) {\n      return <EditorRootBreadcrumbs key=\"EditorRootBreadcrumbs\" {...props} />;\n    },\n\n    renderModals(props) {\n      return <Modals key=\"modals\" {...props} />;\n    },\n\n    renderModal(props) {\n      return null;\n    },\n\n    getActiveModalProps(props) {\n      return null;\n    },\n\n    renderDoc({ children }) {\n      return children;\n    },\n\n    renderRootWidget(props) {\n      return <RootWidget {...props} />;\n    },\n\n    renderTopicWidget(props) {\n      return <TopicWidget {...props} />;\n    },\n\n    renderTopicContent(props) {\n      return <TopicContentWidget {...props} />;\n    },\n\n    renderTopicCollapseIcon(props) {\n      return <TopicCollapseIcon {...props} />;\n    },\n\n    renderTopicContentOthers(props) {\n      return [];\n    },\n\n    renderTopicBlocks(props) {\n      const { model, topicKey, controller } = props;\n      const topic = model.getTopic(topicKey);\n      const blocks = topic.blocks;\n      const res = [];\n      let i = 0;\n      blocks.forEach(block => {\n        const b = controller.run('renderTopicBlock', {\n          ...props,\n          block,\n          blockKey: `block-${i}`\n        });\n        if (b) {\n          res.push(<React.Fragment key={`block-${i}`}>{b}</React.Fragment>);\n          i++;\n        }\n      });\n      return res;\n    },\n\n    renderTopicBlock(props) {\n      const { controller, block } = props;\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicBlockContent', props);\n        case BlockType.DESC:\n          return controller.run('renderTopicBlockDesc', props);\n        default:\n          break;\n      }\n      return null;\n    },\n\n    renderTopicBlockContent(props) {\n      return <TopicContent {...props} />;\n    },\n\n    renderTopicBlockDesc(props) {\n      return <TopicDesc {...props} />;\n    },\n\n    renderSubLinks(props) {\n      const { saveRef, topicKey, model } = props;\n      const topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return <TopicSubLinks ref={saveRef(linksRefKey(topicKey))} {...props} />;\n    },\n\n    renderRootSubLinks(props) {\n      // log('renderRootSubLinks');\n      const { saveRef, topicKey } = props;\n      // 这里逻辑有问题,会导致layout 错误\n      // const topic = model.getTopic(topicKey);\n      // if (topic.subKeys.size === 0) return null;\n      return <RootSubLinks ref={saveRef(linksRefKey(topicKey))} {...props} />;\n    },\n\n    renderFocusItemHighlight(props) {\n      const { saveRef } = props;\n      return (\n        <TopicHighlight ref={saveRef(RefKey.FOCUS_HIGHLIGHT_KEY)} {...props} />\n      );\n    },\n\n    renderRootWidgetOtherChildren(props) {\n      const { controller } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      props = { ...props, zoomFactor };\n      return (\n        <>\n          {controller.run('renderRootSubLinks', props)}\n          {controller.run('renderFocusItemHighlight', props)}\n          {controller.run('renderDragAndDropEffect', props)}\n        </>\n      );\n    },\n\n    renderViewPortViewer(props) {\n      return <ViewPortViewer key=\"view-port-viewer\" {...props} />;\n    }\n  };\n}\n","import { TabId, Tabs } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { useState } from 'react';\nimport styled from 'styled-components';\nimport {\n  BaseProps,\n  CloseIcon,\n  IconBg,\n  ShowMenuIcon,\n  Title,\n  ZIndex\n} from '../../../../components/common';\nimport { iconClassName, IconName } from '../../../../utils';\n\nconst PanelRoot = styled(ZIndex)`\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n`;\n\nconst StyledTabs = styled(Tabs)`\n  padding: 0px 10px;\n`;\n\nexport type RightTopPanelProps = BaseProps & {\n  selectedTabId: TabId;\n  handleTabIdChange: (tabId: TabId) => void;\n  zIndex: number;\n};\n\nexport function RightTopPanel(props: RightTopPanelProps) {\n  const { controller, zIndex, selectedTabId, handleTabIdChange } = props;\n  const [expand, setExpand] = useState(false);\n\n  if (!expand) {\n    return (\n      <PanelRoot zIndex={zIndex}>\n        <IconBg onClick={() => setExpand(true)}>\n          <ShowMenuIcon className={iconClassName(IconName.SHOW_MENU)} />\n        </IconBg>\n      </PanelRoot>\n    );\n  }\n\n  return (\n    <PanelRoot zIndex={zIndex}>\n      <Title>\n        <CloseIcon\n          className={iconClassName(IconName.CLOSE)}\n          onClick={() => setExpand(false)}\n        />\n      </Title>\n      <StyledTabs id={selectedTabId} onChange={handleTabIdChange}>\n        {controller.run('renderRightTopPanelTabs', props)}\n      </StyledTabs>\n    </PanelRoot>\n  );\n}\n","import styled from 'styled-components';\n\nexport const SettingTitle = styled.div`\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n`;\n\nexport const SettingItem = styled.span`\n  margin: 0px 10px 0px 0px;\n`;\n\nexport const SettingBoxContainer = styled.div`\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n`;\n\nexport const SettingLabel = styled(SettingItem)``;\n\nexport const SettingRow = styled.div`\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n`;\n\nexport const ColorBar = styled.div`\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ${props => props.color};\n`;\n\nexport const WithBorder = styled.div`\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n`;\n","import {\n  Button,\n  Divider,\n  MenuItem,\n  NumericInput,\n  Popover\n} from '@blueprintjs/core';\nimport { Select } from '@blueprintjs/select';\nimport { ItemRenderer } from '@blueprintjs/select/src/common/itemRenderer';\nimport * as React from 'react';\nimport { SketchPicker } from 'react-color';\nimport { Flex, Margin } from '../../../../components/common';\nimport { iconClassName, IconName } from '../../../../utils';\nimport { ColorBar, SettingItem, WithBorder } from './styled';\nexport function SettingGroup(props) {\n  return (\n    <div>\n      {props.children}\n      <Divider style={{ margin: '10px 0' }} />\n    </div>\n  );\n}\n\nexport function SettingItemColorPicker(props: {\n  color: string;\n  handleColorChange: (color: string) => void;\n}) {\n  const { color, handleColorChange } = props;\n  return (\n    <SettingItem>\n      <Popover>\n        <WithBorder>\n          <div className={iconClassName(IconName.COLOR_PICKER)} />\n          <ColorBar color={color} />\n        </WithBorder>\n        <div>\n          <SketchPicker\n            color={color}\n            onChangeComplete={color => handleColorChange(color.hex)}\n          />\n        </div>\n      </Popover>\n    </SettingItem>\n  );\n}\n\nexport function SettingItemButton(props: {\n  title: string;\n  handleClick: (e) => void;\n}) {\n  const { title, handleClick } = props;\n  return (\n    <SettingItem>\n      <Button onClick={handleClick}>{title}</Button>\n    </SettingItem>\n  );\n}\n\nexport interface SettingItemNumericInputProps {\n  layout?: string;\n  title: string;\n  value: number;\n  min: number;\n  max: number;\n  onValueChange: (valueAsNumber: number, valueAsString: string) => void;\n}\n\nexport function SettingItemNumericInput(props: SettingItemNumericInputProps) {\n  const { layout = 'h', title, ...restProps } = props;\n  const flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return (\n    <SettingItem>\n      <Flex {...flexProps}>\n        <Margin margin=\"0 5px 0 0\">{title}</Margin>\n        <NumericInput {...restProps} />\n      </Flex>\n    </SettingItem>\n  );\n}\n\nexport function SettingItemSelect<T>(props: {\n  text: string;\n  items: T[];\n  itemRenderer: ItemRenderer<T>;\n  onItemSelect: (item: T, event?: React.SyntheticEvent<HTMLElement>) => void;\n}) {\n  const { text, items, itemRenderer, onItemSelect } = props;\n  const PxSelect = Select.ofType<T>();\n  const pxProps = {\n    items,\n    itemRenderer,\n    onItemSelect,\n    filterable: false\n  };\n  return (\n    <SettingItem>\n      <PxSelect {...pxProps}>\n        <Button text={text} />\n      </PxSelect>\n    </SettingItem>\n  );\n}\n\nexport const renderItem = unit => (width, { handleClick }) => {\n  return (\n    <MenuItem text={`${width}${unit}`} key={width} onClick={handleClick} />\n  );\n};\n\nexport const PxSelect = Select.ofType();\n\nexport const borderWidthItems = [...Array(7).keys()];\n","import * as React from 'react';\nimport {\n  renderItem,\n  SettingGroup,\n  SettingItemColorPicker,\n  SettingItemSelect,\n  SettingTitle\n} from '../right-top-panel';\nimport { ContentStyleEditorProps } from './types';\n\nconst borderWidthItems = [...Array(7).keys()];\nconst borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\nconst borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n\nexport function BorderStyleEditor(props: ContentStyleEditorProps) {\n  const { contentStyle, setContentStyle } = props;\n  const handleBorderWidthChange = value => {\n    // log('handleBorderWithChange:', value);\n    setContentStyle({ borderWidth: `${value}px` });\n  };\n\n  const handleBorderStyleChange = value => {\n    setContentStyle({ borderStyle: value });\n  };\n\n  const handleBorderRadiusChange = value => {\n    // log('handleBorderRadiusChange:', value);\n    setContentStyle({ borderRadius: `${value}px` });\n  };\n\n  const handleBorderColorChange = color => {\n    setContentStyle({ borderColor: color });\n  };\n\n  return (\n    <SettingGroup>\n      <SettingTitle>Border</SettingTitle>\n      <div>\n        <SettingItemSelect\n          text={`width: ${\n            contentStyle.borderWidth ? contentStyle.borderWidth : '0px'\n          }`}\n          items={borderWidthItems}\n          itemRenderer={renderItem('px')}\n          onItemSelect={handleBorderWidthChange}\n        />\n        <SettingItemSelect\n          text={`style: ${\n            contentStyle.borderStyle ? contentStyle.borderStyle : 'none'\n          }`}\n          items={borderStyleItems}\n          itemRenderer={renderItem('')}\n          onItemSelect={handleBorderStyleChange}\n        />\n        <SettingItemSelect\n          text={`radius: ${contentStyle.borderRadius}`}\n          items={borderRadiusItems}\n          itemRenderer={renderItem('px')}\n          onItemSelect={handleBorderRadiusChange}\n        />\n        <SettingItemColorPicker\n          color={contentStyle.borderColor}\n          handleColorChange={handleBorderColorChange}\n        />\n      </div>\n    </SettingGroup>\n  );\n}\n","import { Button } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { SettingGroup, SettingItem } from '../right-top-panel';\n\nexport function ClearAllCustomStyle(props) {\n  const { controller } = props;\n  const handleClearAllCustomStyle = e => {\n    controller.run('clearAllCustomStyle', props);\n  };\n\n  return (\n    <SettingGroup>\n      <SettingItem>\n        <Button onClick={handleClearAllCustomStyle}>\n          Clear All Custom Styles\n        </Button>\n      </SettingItem>\n    </SettingGroup>\n  );\n}\n","import { LinkStyle } from '@blink-mind/core';\nimport { MenuItem } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { Margin } from '../../../../components/common';\nimport {\n  borderWidthItems,\n  renderItem,\n  SettingGroup,\n  SettingItemColorPicker,\n  SettingItemSelect,\n  SettingRow,\n  SettingTitle\n} from '../right-top-panel';\n\nconst lineTypes = ['curve', 'round', 'line'];\n\nconst renderLineTypeItem = (lineType, { handleClick, modifiers, query }) => {\n  return <MenuItem text={`${lineType}`} key={lineType} onClick={handleClick} />;\n};\n\nexport interface LinkStyleEditorProps {\n  showLinkStyle?: boolean;\n  showSubLinkStyle?: boolean;\n  linkStyle: LinkStyle;\n  subLinkStyle: LinkStyle;\n  setLinkStyle: (LinkStyle) => void;\n  setSubLinkStyle: (LinkStyle) => void;\n}\n\nexport function LinkStyleEditor(props: LinkStyleEditorProps) {\n  const {\n    showLinkStyle = true,\n    showSubLinkStyle = true,\n    linkStyle = {},\n    subLinkStyle = {},\n    setLinkStyle,\n    setSubLinkStyle\n  } = props;\n\n  const handleLinkWidthChange = value => {\n    setLinkStyle({ lineWidth: `${value}px` });\n  };\n\n  const handleLinkTypeChange = value => {\n    setLinkStyle({ lineType: value });\n  };\n\n  const handleLinkColorChange = color => {\n    setLinkStyle({ lineColor: color });\n  };\n\n  const handleSubLinkWidthChange = value => {\n    setSubLinkStyle({ lineWidth: `${value}px` });\n  };\n\n  const handleSubLinkTypeChange = value => {\n    setSubLinkStyle({ lineType: value });\n  };\n\n  const handleSubLinkColorChange = color => {\n    setSubLinkStyle({ lineColor: color });\n  };\n  return (\n    <SettingGroup>\n      <SettingTitle>Link</SettingTitle>\n      {showLinkStyle && (\n        <SettingRow alignItems=\"center\">\n          <Margin margin=\"0 5px 0 0\">LinkToParent: </Margin>\n          <SettingItemSelect\n            text={`width: ${linkStyle ? linkStyle.lineWidth : '0px'}`}\n            items={borderWidthItems}\n            itemRenderer={renderItem('px')}\n            onItemSelect={handleLinkWidthChange}\n          />\n          <SettingItemSelect\n            text={`lineType: ${linkStyle.lineType}`}\n            items={lineTypes}\n            itemRenderer={renderLineTypeItem}\n            onItemSelect={handleLinkTypeChange}\n          />\n          <SettingItemColorPicker\n            color={linkStyle.lineColor}\n            handleColorChange={handleLinkColorChange}\n          />\n        </SettingRow>\n      )}\n      {showSubLinkStyle && (\n        <SettingRow alignItems=\"center\">\n          <Margin margin=\"0 5px 0 0\">SubLinks: </Margin>\n          <SettingItemSelect\n            text={`width: ${subLinkStyle ? subLinkStyle.lineWidth : '0px'}`}\n            items={borderWidthItems}\n            itemRenderer={renderItem('px')}\n            onItemSelect={handleSubLinkWidthChange}\n          />\n          <SettingItemSelect\n            text={`lineType: ${subLinkStyle.lineType}`}\n            items={lineTypes}\n            itemRenderer={renderLineTypeItem}\n            onItemSelect={handleSubLinkTypeChange}\n          />\n          <SettingItemColorPicker\n            color={subLinkStyle.lineColor}\n            handleColorChange={handleSubLinkColorChange}\n          />\n        </SettingRow>\n      )}\n    </SettingGroup>\n  );\n}\n","import { InputGroup } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { Flex, Margin } from '../../../../components/common';\nimport {\n  SettingGroup,\n  SettingItem,\n  SettingItemColorPicker,\n  SettingItemNumericInput,\n  SettingTitle\n} from '../right-top-panel';\nimport { ContentStyleEditorProps } from './types';\n\nexport function TextStyleEditor(props: ContentStyleEditorProps) {\n  const { contentStyle, setContentStyle } = props;\n  const handleFontSizeChange = value => {\n    // log('handleFontSizeChange:', value);\n    setContentStyle({ fontSize: value });\n  };\n\n  const handleLineHeightChange = e => {\n    // log('handleLineHeightChange:', e.target.value);\n    setContentStyle({ lineHeight: e.target.value });\n  };\n\n  const handleColorChange = color => {\n    setContentStyle({ color });\n  };\n\n  const fontSizeNumInputProps = {\n    title: 'FontSize:',\n    min: 12,\n    max: 100,\n    value: parseInt(contentStyle.fontSize),\n    style: {\n      width: 50\n    },\n    onValueChange: handleFontSizeChange\n  };\n  const lineHeightInputProps = {\n    style: {\n      width: 50\n    },\n    value: contentStyle.lineHeight || '',\n    onChange: handleLineHeightChange\n  };\n  return (\n    <SettingGroup>\n      <SettingTitle>Text Editor</SettingTitle>\n      <Flex>\n        <SettingItemNumericInput {...fontSizeNumInputProps} />\n        <SettingItem>\n          <Flex alignItems=\"center\">\n            <Margin margin=\"0 5px 0 0\">LineHeight: </Margin>\n            <InputGroup {...lineHeightInputProps} />\n          </Flex>\n        </SettingItem>\n        <SettingItemColorPicker\n          color={contentStyle.color}\n          handleColorChange={handleColorChange}\n        />\n      </Flex>\n    </SettingGroup>\n  );\n}\n","import { LinkStyle, OpType, TopicContentStyle } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport { BaseProps, PanelTabRoot } from '../../../../components/common';\nimport {\n  SettingGroup,\n  SettingItemButton,\n  SettingItemColorPicker,\n  SettingTitle\n} from '../right-top-panel/';\nimport { BorderStyleEditor } from './border-style-editor';\nimport { ClearAllCustomStyle } from './clear-all-custom-style';\nimport { LinkStyleEditor, LinkStyleEditorProps } from './link-style-editor';\nimport { TextStyleEditor } from './text-style-editor';\nimport { ContentStyleEditorProps } from './types';\n\nconst log = debug('node:style-editor');\n\nlet copiedStyle;\n\nexport function StyleEditor(props: BaseProps) {\n  const { controller, model, topicKey } = props;\n  const topic = model.getTopic(topicKey);\n  const setContentStyle = style => {\n    controller.run('setTopicContentStyle', { ...props, style });\n  };\n\n  const handleBackgroundColorChange = color => {\n    setContentStyle({ background: color });\n  };\n\n  const handleClearStyle = () => {\n    if (topic.style) {\n      controller.run('operation', {\n        ...props,\n        opType: OpType.SET_STYLE,\n        style: null\n      });\n    }\n  };\n\n  const handleCopyStyle = () => {\n    copiedStyle = controller.run('getTopicStyle', props);\n    log(copiedStyle);\n  };\n\n  const handlePasteStyle = () => {\n    if (copiedStyle) {\n      controller.run('operation', {\n        ...props,\n        opType: OpType.SET_STYLE,\n        style: JSON.stringify(copiedStyle)\n      });\n    }\n  };\n\n  if (!model.focusKey) return null;\n  const contentStyle: TopicContentStyle = controller.run(\n    'getTopicContentStyle',\n    props\n  );\n\n  const linkStyle: LinkStyle = controller.run('getLinkStyle', props);\n  const subLinkStyle: LinkStyle = controller.run('getSubLinkStyle', props);\n  const setLinkStyle = linkStyle => {\n    controller.run('setLinkStyle', {\n      ...props,\n      linkStyle\n    });\n  };\n\n  const setSubLinkStyle = subLinkStyle => {\n    controller.run('setSubLinkStyle', {\n      ...props,\n      subLinkStyle\n    });\n  };\n\n  const linkStyleEditorProps: LinkStyleEditorProps = {\n    linkStyle,\n    subLinkStyle,\n    setLinkStyle,\n    setSubLinkStyle\n  };\n\n  const contentStyleEditorPros: ContentStyleEditorProps = {\n    contentStyle,\n    setContentStyle\n  };\n\n  return (\n    <PanelTabRoot>\n      <BorderStyleEditor {...contentStyleEditorPros} />\n      <TextStyleEditor {...contentStyleEditorPros} />\n      <SettingGroup>\n        <SettingTitle>Background</SettingTitle>\n        <SettingItemColorPicker\n          color={contentStyle.background}\n          handleColorChange={handleBackgroundColorChange}\n        />\n      </SettingGroup>\n      <LinkStyleEditor {...linkStyleEditorProps} />\n      <SettingGroup>\n        <SettingItemButton\n          title=\"Clear Topic Style\"\n          handleClick={handleClearStyle}\n        />\n        <SettingItemButton title=\"Copy Style\" handleClick={handleCopyStyle} />\n        <SettingItemButton title=\"Paste Style\" handleClick={handlePasteStyle} />\n      </SettingGroup>\n      {ClearAllCustomStyle(props)}\n    </PanelTabRoot>\n  );\n}\n","import * as React from 'react';\n/** Event handler that exposes the target element's value as a boolean. */\nexport function handleBooleanChange(handler: (checked: boolean) => void) {\n  return (event: React.FormEvent<HTMLElement>) =>\n    handler((event.target as HTMLInputElement).checked);\n}\n\n/** Event handler that exposes the target element's value as a string. */\nexport function handleStringChange(handler: (value: string) => void) {\n  return (event: React.FormEvent<HTMLElement>) =>\n    handler((event.target as HTMLInputElement).value);\n}\n\n/** Event handler that exposes the target element's value as a number. */\nexport function handleNumberChange(handler: (value: number) => void) {\n  return handleStringChange(value => handler(+value));\n}\n","import * as React from 'react';\nimport { paddingCss } from '../../../../utils';\nimport {\n  SettingGroup,\n  SettingItemNumericInput,\n  SettingRow,\n  SettingTitle\n} from '../right-top-panel';\nimport { ContentStyleEditorProps } from './types';\n\nconst expand = require('css-shorthand-expand');\n\nexport function PaddingStyleEditor(props: ContentStyleEditorProps) {\n  const { contentStyle, setContentStyle } = props;\n  const padding = expand('padding', contentStyle.padding || '0');\n  const commonProps = {\n    layout: 'v',\n    min: 0,\n    max: 99,\n    style: {\n      width: 38\n    }\n  };\n  const top = parseInt(padding['padding-top']);\n  const right = parseInt(padding['padding-right']);\n  const bottom = parseInt(padding['padding-bottom']);\n  const left = parseInt(padding['padding-left']);\n  const p = {\n    top,\n    right,\n    bottom,\n    left\n  };\n\n  const setPadding = dir => v => {\n    setContentStyle({ padding: paddingCss({ ...p, [dir]: v }) });\n  };\n  const topProps = {\n    ...commonProps,\n    title: 'top',\n    value: top,\n    onValueChange: setPadding('top')\n  };\n  const rightProps = {\n    ...commonProps,\n    title: 'right',\n    value: right,\n    onValueChange: setPadding('right')\n  };\n  const bottomProps = {\n    ...commonProps,\n    title: 'bottom',\n    value: bottom,\n    onValueChange: setPadding('bottom')\n  };\n  const leftProps = {\n    ...commonProps,\n    title: 'left',\n    value: left,\n    onValueChange: setPadding('left')\n  };\n  return (\n    <SettingGroup>\n      <SettingTitle>Padding</SettingTitle>\n      <SettingRow>\n        <SettingItemNumericInput {...topProps} />\n        <SettingItemNumericInput {...rightProps} />\n        <SettingItemNumericInput {...bottomProps} />\n        <SettingItemNumericInput {...leftProps} />\n      </SettingRow>\n    </SettingGroup>\n  );\n}\n","import { LinkStyle, TopicContentStyle, TopicStyle } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport {\n  SettingGroup,\n  SettingItemColorPicker,\n  SettingTitle\n} from '../right-top-panel';\nimport { BorderStyleEditor } from '../style-editor/border-style-editor';\nimport { LinkStyleEditor } from '../style-editor/link-style-editor';\nimport { PaddingStyleEditor } from '../style-editor/padding-style-editor';\nimport { TextStyleEditor } from '../style-editor/text-style-editor';\nimport { ContentStyleEditorProps } from '../style-editor/types';\n\nconst TopicThemeEditorRoot = styled.div`\n  height: 250px;\n  overflow: auto;\n`;\n\nexport interface TopicThemeEditorProps {\n  topicStyle: TopicStyle;\n  setTopicStyle: (style: TopicStyle) => void;\n}\n\nexport function TopicThemeEditor(props: TopicThemeEditorProps) {\n  const { topicStyle, setTopicStyle } = props;\n  const { contentStyle = {}, linkStyle = {}, subLinkStyle = {} } = topicStyle;\n\n  const setContentStyle = (contentStyle: TopicContentStyle) => {\n    setTopicStyle({ contentStyle });\n  };\n\n  const nProps: ContentStyleEditorProps = {\n    contentStyle,\n    setContentStyle\n  };\n\n  const setLinkStyle = (linkStyle: LinkStyle) => {\n    setTopicStyle({ linkStyle });\n  };\n\n  const setSubLinkStyle = (subLinkStyle: LinkStyle) => {\n    setTopicStyle({ subLinkStyle });\n  };\n\n  const linkStyleEditorProps = {\n    showLinkStyle: false,\n    linkStyle,\n    subLinkStyle,\n    setLinkStyle,\n    setSubLinkStyle\n  };\n  return (\n    <TopicThemeEditorRoot>\n      <BorderStyleEditor {...nProps} />\n      <PaddingStyleEditor {...nProps} />\n      <TextStyleEditor {...nProps} />\n      <SettingGroup>\n        <SettingTitle>Background</SettingTitle>\n        <SettingItemColorPicker\n          color={contentStyle.background}\n          handleColorChange={color => {\n            setContentStyle({ background: color });\n          }}\n        />\n      </SettingGroup>\n      <LinkStyleEditor {...linkStyleEditorProps} />\n    </TopicThemeEditorRoot>\n  );\n}\n","import { isThemeType, OpType, ThemeType, TopicStyle } from '@blink-mind/core';\nimport { Alert, Tab, Tabs } from '@blueprintjs/core';\nimport { clone, merge } from 'lodash';\nimport * as React from 'react';\nimport { useState } from 'react';\nimport {\n  BaseProps,\n  PanelTabRoot,\n  StyledCheckbox\n} from '../../../../components/common';\nimport { browserDownloadText, browserOpenFile } from '../../../../utils';\nimport { handleBooleanChange } from '../../../../utils/blueprint';\nimport {\n  SettingBoxContainer,\n  SettingGroup,\n  SettingItemButton,\n  SettingItemColorPicker,\n  SettingLabel,\n  SettingRow,\n  SettingTitle\n} from '../right-top-panel';\nimport { TopicThemeEditor, TopicThemeEditorProps } from './topic-theme-editor';\n\nlet tabId = 'normal';\n\nexport function ThemeEditor(props: BaseProps) {\n  const [showExportDialog, setShowExportDialog] = useState(false);\n  const [alertThemeError, setAlertThemeError] = useState(false);\n  const { model, controller } = props;\n  const theme: ThemeType = model.config.theme;\n\n  const { rootTopic, primaryTopic, normalTopic } = theme;\n\n  const setTheme = theme => {\n    controller.run('operation', {\n      ...props,\n      opType: OpType.SET_THEME,\n      theme: clone(theme)\n    });\n  };\n\n  const handleBackgroundColorChange = background => {\n    setTheme(merge(theme, { background }));\n  };\n\n  const handleHighlightColorChange = highlightColor => {\n    setTheme(merge(theme, { highlightColor }));\n  };\n\n  const handleRandomColorChange = handleBooleanChange(randomColor => {\n    setTheme(merge(theme, { randomColor }));\n  });\n\n  const setRootTopicStyle = (style: TopicStyle) => {\n    setTheme(merge(theme, { rootTopic: style }));\n  };\n\n  const setPrimaryTopicStyle = (style: TopicStyle) => {\n    setTheme(merge(theme, { primaryTopic: style }));\n  };\n\n  const setNormalTopicStyle = (style: TopicStyle) => {\n    setTheme(merge(theme, { normalTopic: style }));\n  };\n\n  const rootTopicEditorProps: TopicThemeEditorProps = {\n    topicStyle: rootTopic,\n    setTopicStyle: setRootTopicStyle\n  };\n\n  const rootTopicEditor = <TopicThemeEditor {...rootTopicEditorProps} />;\n\n  const primaryTopicEditorProps: TopicThemeEditorProps = {\n    topicStyle: primaryTopic,\n    setTopicStyle: setPrimaryTopicStyle\n  };\n\n  const primaryTopicEditor = <TopicThemeEditor {...primaryTopicEditorProps} />;\n\n  const normalTopicEditorProps: TopicThemeEditorProps = {\n    topicStyle: normalTopic,\n    setTopicStyle: setNormalTopicStyle\n  };\n\n  const normalTopicEditor = <TopicThemeEditor {...normalTopicEditorProps} />;\n\n  const tabsProps = {\n    id: tabId,\n    handleTabIdChange: id => {\n      tabId = id;\n    }\n  };\n\n  const topicThemes = (\n    <SettingBoxContainer>\n      <Tabs {...tabsProps}>\n        <Tab id=\"normal\" title=\"NormalTopic\" panel={normalTopicEditor} />\n        <Tab id=\"primary\" title=\"PrimaryTopic\" panel={primaryTopicEditor} />\n        <Tab id=\"root\" title=\"RootTopic\" panel={rootTopicEditor} />\n      </Tabs>\n    </SettingBoxContainer>\n  );\n\n  const handleExportTheme = e => {\n    // setShowExportDialog(true);\n    const text = JSON.stringify(theme);\n    browserDownloadText(text, 'blink-mind-theme.json');\n  };\n  const handleImportTheme = e => {\n    browserOpenFile('.json,.txt').then(txt => {\n      const t: ThemeType = JSON.parse(txt);\n      if (!isThemeType(t)) {\n        setAlertThemeError(true);\n        return;\n      }\n      setTheme(t);\n    });\n  };\n  const alertProps = {\n    isOpen: alertThemeError,\n    onClose: e => {\n      setAlertThemeError(false);\n    }\n  };\n  const alert = (\n    <Alert {...alertProps}>\n      <p>File format error</p>\n    </Alert>\n  );\n\n  return (\n    <PanelTabRoot>\n      <SettingGroup>\n        <SettingTitle>Global</SettingTitle>\n        <SettingRow>\n          <SettingLabel>Background:</SettingLabel>\n          <SettingItemColorPicker\n            color={theme.background}\n            handleColorChange={handleBackgroundColorChange}\n          />\n          <SettingLabel>Highlight:</SettingLabel>\n          <SettingItemColorPicker\n            color={theme.highlightColor}\n            handleColorChange={handleHighlightColorChange}\n          />\n          <SettingLabel>Random Color:</SettingLabel>\n          <StyledCheckbox\n            checked={theme.randomColor}\n            onChange={handleRandomColorChange}\n          />\n        </SettingRow>\n      </SettingGroup>\n      {topicThemes}\n\n      <SettingGroup>\n        <SettingItemButton\n          title=\"Export Theme\"\n          handleClick={handleExportTheme}\n        />\n        <SettingItemButton\n          title=\"Import Theme\"\n          handleClick={handleImportTheme}\n        />\n      </SettingGroup>\n\n      {/*<Dialog*/}\n      {/*  onClose={()=>setShowExportDialog(false)}*/}\n      {/*  isOpen={showExportDialog}*/}\n      {/*  autoFocus*/}\n      {/*  enforceFocus*/}\n      {/*  usePortal*/}\n      {/*  title=\"Please input the export file name\"*/}\n      {/*>*/}\n      {/*  */}\n      {/*</Dialog>*/}\n      {alert}\n    </PanelTabRoot>\n  );\n}\n","import { Tab } from '@blueprintjs/core';\nimport * as React from 'react';\nimport {\n  RightTopPanel,\n  RightTopPanelProps\n} from './components/right-top-panel/right-top-panel';\nimport { StyleEditor } from './components/style-editor';\nimport { ThemeEditor } from './components/theme-editor';\n\nexport function RightTopPanelPlugin() {\n  let selectedTabId = 'topic-style';\n  const handleTabIdChange = tabId => {\n    selectedTabId = tabId;\n  };\n  return {\n    renderRightTopPanel(props) {\n      const nProps: RightTopPanelProps = {\n        ...props,\n        key: 'right-top-panel',\n        selectedTabId,\n        handleTabIdChange\n      };\n      return <RightTopPanel {...nProps} />;\n    },\n\n    renderRightTopPanelTabs(props) {\n      const { controller } = props;\n      const styleEditorTab = controller.run('renderTopicStyleEditor', props);\n      const themeEditorTab = controller.run('renderThemeEditor', props);\n\n      return [styleEditorTab, themeEditorTab];\n    },\n\n    renderTopicStyleEditor(props) {\n      const tProps = {\n        id: 'topic-style',\n        key: 'topic-style',\n        title: 'TopicStyle',\n        panel: <StyleEditor {...props} />\n      };\n      return <Tab {...tProps} />;\n    },\n\n    renderThemeEditor(props) {\n      const tProps = {\n        id: 'theme-editor',\n        key: 'theme-editor',\n        title: 'Theme',\n        panel: <ThemeEditor {...props} />\n      };\n      return <Tab {...tProps} />;\n    }\n  };\n}\n","import debug from 'debug';\nconst log = debug('plugin:utils');\nexport function UtilsPlugin() {\n  const tempValueMap = new Map();\n  const eventListenerMap = new Map();\n  return {\n    addTempValueChangeListener(props) {\n      const { key, listener } = props;\n      if (!eventListenerMap.has(key)) {\n        eventListenerMap.set(key, []);\n      }\n      eventListenerMap.get(key).push(listener);\n    },\n\n    removeTempValueChangeListener(props) {\n      const { key, listener } = props;\n      if (eventListenerMap.has(key)) {\n        eventListenerMap[key] = eventListenerMap\n          .get(key)\n          .filter(l => l !== listener);\n      }\n    },\n\n    getTempValue(props) {\n      const { key } = props;\n      log('getTempValue', key);\n      return tempValueMap.get(key);\n    },\n\n    setTempValue(props) {\n      const { key, value } = props;\n      log('setTempValue', key);\n      tempValueMap.set(key, value);\n      if (eventListenerMap.has(key)) {\n        const listeners = eventListenerMap.get(key);\n        for (const listener of listeners) {\n          listener(value);\n        }\n      }\n    },\n\n    deleteTempValue(props) {\n      const { key } = props;\n      log('deleteTempValue', key);\n      const value = tempValueMap.get(key);\n      tempValueMap.delete(key);\n      return value;\n    }\n  };\n}\n","import { ContextMenuPlugin } from './context-menu';\nimport { DragAndDropPlugin } from './drag-and-drop';\nimport { RenderingPlugin } from './rendering';\nimport { RightTopPanelPlugin } from './right-top-panel-plugin';\nimport { UtilsPlugin } from './utils';\n\nexport function ReactPlugin(options = {}) {\n  return [\n    RenderingPlugin(),\n    UtilsPlugin(),\n    ContextMenuPlugin(),\n    RightTopPanelPlugin(),\n    DragAndDropPlugin()\n  ];\n}\n","import {\n  LinkStyle,\n  OpType,\n  ThemeType,\n  TopicStyle,\n  TopicVisualLevel\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport { isEqual } from 'lodash';\n\nconst log = debug('plugin:StylePlugin');\n\nexport function StylePlugin() {\n  const colorMap = new Map();\n  let colorIndex = 0;\n  return {\n    getTopicStyle(props): TopicStyle {\n      const { controller } = props;\n      return {\n        contentStyle: controller.run('getTopicContentStyle', props),\n        linkStyle: controller.run('getLinkStyle', props),\n        subLinkStyle: controller.run('getSubLinkStyle', props)\n      };\n    },\n\n    getTopicContentStyle(props): TopicStyle {\n      const { topicKey, model, controller } = props;\n      log('getTopicContentStyle:', topicKey, model);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        themeStyle = theme.primaryTopic;\n      else themeStyle = theme.normalTopic;\n\n      themeStyle = { ...theme.contentStyle, ...themeStyle.contentStyle };\n\n      if (theme.randomColor) {\n        const randomColor = controller.run('getRandomColor', props);\n        themeStyle = {\n          ...themeStyle,\n          background: randomColor,\n          borderColor: randomColor,\n          subLinkStyle: {\n            ...themeStyle.subLinkStyle,\n            lineColor: randomColor\n          }\n        };\n      }\n      const topic = model.getTopic(topicKey);\n      if (!topic.style) {\n        return themeStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      return {\n        ...themeStyle,\n        ...customStyle.contentStyle\n      };\n    },\n\n    getLinkStyle(props): LinkStyle {\n      const { topicKey, model, controller } = props;\n      log('getLinkStyle', topicKey);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme: ThemeType = model.config.theme;\n      let linkStyle: LinkStyle = theme.linkStyle;\n      let presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT)\n        presetStyle = theme.rootTopic.linkStyle;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        presetStyle = theme.primaryTopic.linkStyle;\n      else presetStyle = theme.normalTopic.linkStyle;\n\n      linkStyle = { ...linkStyle, ...presetStyle };\n\n      const topic = model.getTopic(topicKey);\n\n      if (topic.parentKey != null) {\n        const parentSubLinkStyle = controller.run('getSubLinkStyle', {\n          ...props,\n          topicKey: topic.parentKey\n        });\n\n        linkStyle = {\n          ...linkStyle,\n          ...parentSubLinkStyle\n        };\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      return {\n        ...linkStyle,\n        ...customStyle.linkStyle\n      };\n    },\n\n    getSubLinkStyle(props): LinkStyle {\n      const { topicKey, model, controller } = props;\n      log('getLinkStyle', topicKey);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let subLinkStyle = theme.linkStyle;\n      let presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT)\n        presetStyle = theme.rootTopic.subLinkStyle;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        presetStyle = theme.primaryTopic.subLinkStyle;\n      else presetStyle = theme.normalTopic.subLinkStyle;\n\n      subLinkStyle = { ...subLinkStyle, ...presetStyle };\n\n      const topic = model.getTopic(topicKey);\n      // 获取父节点的color\n      if (theme.randomColor) {\n        const randomColor = controller.run('getRandomColor', props);\n        log(randomColor);\n        subLinkStyle = {\n          ...subLinkStyle,\n          lineColor: randomColor\n        };\n      }\n\n      if (!topic.style) {\n        return subLinkStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      const res = {\n        ...subLinkStyle,\n        ...customStyle.subLinkStyle\n      };\n      // if (res.lineRadius == null) res.lineRadius = 5;\n      return res;\n    },\n\n    setTopicContentStyle(props) {\n      const { topicKey, controller, style, model } = props;\n      const topic = model.getTopic(topicKey);\n      const topicStyle = topic.style;\n      const styleObj = topicStyle ? JSON.parse(topicStyle) : {};\n      const newStyleObj = {\n        ...styleObj,\n        contentStyle: {\n          ...styleObj.contentStyle,\n          ...style\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    setLinkStyle(props) {\n      const { topicKey, controller, linkStyle, model } = props;\n      const topic = model.getTopic(topicKey);\n      const style = topic.style;\n      const styleObj = style ? JSON.parse(style) : {};\n      const newStyleObj = {\n        ...styleObj,\n        linkStyle: {\n          ...styleObj.linkStyle,\n          ...linkStyle\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    setSubLinkStyle(props) {\n      const { topicKey, controller, subLinkStyle, model } = props;\n      const topic = model.getTopic(topicKey);\n      const style = topic.style;\n      const styleObj = style ? JSON.parse(style) : {};\n      const newStyleObj = {\n        ...styleObj,\n        subLinkStyle: {\n          ...styleObj.subLinkStyle,\n          ...subLinkStyle\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    getTopicThemeStyle(props): TopicStyle {\n      const { topicKey, model } = props;\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n\n    getRandomColor(props) {\n      const { topicKey } = props;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      const colors = [\n        '#00CC99',\n        '#FFEE88',\n        '#A167A5',\n        '#E5F993',\n        '#F5C396',\n        '#DB995A',\n        '#83BCFF',\n        '#ED7B84',\n        '#739E82',\n        '#D3BCC0',\n        '#FFA0FD',\n        '#EFD3D7',\n        '#C6878F'\n      ];\n      const color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      log('getRandomColor', topicKey, color);\n      return color;\n    },\n\n    clearAllCustomStyle(props) {\n      const { model, controller } = props;\n      const newModel = model.withMutations(model => {\n        model.topics.keySeq().forEach(key => {\n          model.setIn(['topics', key, 'style'], null);\n        });\n      });\n      controller.change(newModel);\n    }\n  };\n}\n","import SimpleTextEditorPlugin from '@blink-mind/plugin-simple-text-editor';\nimport { EventPlugin } from './event';\nimport { GetValuePlugin } from './get-value';\nimport { HotKeyPlugin } from './hotkey';\nimport { LayoutPlugin } from './layout';\nimport { OperationPlugin } from './operation';\nimport { ReactPlugin } from './react';\nimport { StylePlugin } from './style';\n\nexport * from './hotkey';\n\nexport function DefaultPlugin() {\n  return [\n    ReactPlugin(),\n    LayoutPlugin(),\n    OperationPlugin(),\n    StylePlugin(),\n    EventPlugin(),\n    HotKeyPlugin(),\n    GetValuePlugin(),\n    SimpleTextEditorPlugin()\n  ];\n}\n","import {\n  Controller,\n  IDiagram,\n  IDiagramProps,\n  Model,\n  OnChangeFunction,\n  OpType\n} from '@blink-mind/core';\n// TODO\nimport '@blink-mind/icons';\n\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport debug from 'debug';\nimport memoizeOne from 'memoize-one';\nimport * as React from 'react';\nimport { DefaultPlugin, HotKeysConfig } from '../plugins';\nimport './diagram.css';\nconst log = debug('node:Diagram');\n\ninterface Props {\n  model: Model;\n  onChange: OnChangeFunction;\n  commands?: any;\n  plugins?: any;\n}\n\nexport class Diagram extends React.Component<Props> implements IDiagram {\n  controller: Controller;\n\n  public getDiagramProps(): IDiagramProps {\n    return this.controller.run('getDiagramProps');\n  }\n\n  public openNewModel(newModel: Model) {\n    const props = this.getDiagramProps();\n    const { model, controller } = props;\n    controller.run('deleteRefKey', {\n      ...props,\n      topicKey: model.rootTopicKey\n    });\n    controller.run('operation', {\n      ...props,\n      opType: OpType.EXPAND_TO,\n      topicKey: newModel.focusKey,\n      model: newModel,\n      callback: () => {\n        const props = this.getDiagramProps();\n        const { model } = props;\n        controller.run('moveTopicToCenter', {\n          ...props,\n          topicKey: model.focusKey\n        });\n      }\n    });\n  }\n\n  private diagramProps: IDiagramProps;\n\n  private resolveController = memoizeOne((plugins = [], TheDefaultPlugin) => {\n    const defaultPlugin = TheDefaultPlugin();\n    this.controller = new Controller({\n      plugins: [plugins, defaultPlugin],\n      construct: false,\n      onChange: this.props.onChange\n    });\n    // this.controller.run('onConstruct');\n  });\n\n  render() {\n    const { plugins } = this.props;\n    this.resolveController(plugins, DefaultPlugin);\n    this.diagramProps = {\n      ...this.props,\n      controller: this.controller\n    };\n    return this.controller.run('renderDiagram', this.diagramProps);\n  }\n}\n"],"names":["React.PureComponent","React.createElement","React.Component","log","Icon","cancelEvent","TopicContent","React.Fragment","borderWidthItems"],"mappings":"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"}