{"version":3,"file":"main.es.js","sources":["../src/topic-reference/utils.ts","../src/topic-reference/add-reference-topic-panel.tsx","../src/topic-reference/ext-data-reference.ts","../src/topic-reference/op-function.ts","../src/topic-reference/reference-topic-thumbnail.tsx","../src/topic-reference/reference-topic-list.tsx","../src/topic-reference/topic-ext-reference.tsx","../src/topic-reference/topic-reference-checkbox.tsx","../src/topic-reference/topic-reference-plugin.tsx","../src/search/search-panel.tsx","../src/search/utils.ts","../src/search/search-plugin.tsx"],"sourcesContent":["export const FOCUS_MODE_SET_REFERENCE_TOPICS =\n  'FOCUS_MODE_SET_REFERENCE_TOPICS';\n// 添加引用的Topic\nexport const OP_TYPE_START_SET_REFERENCE_TOPICS =\n  'OP_TYPE_START_SET_REFERENCE_TOPICS';\nexport const OP_TYPE_SET_REFERENCE_TOPICS = 'OP_TYPE_SET_REFERENCE_TOPICS';\n\nexport const EXT_DATA_KEY_TOPIC_REFERENCE = 'TOPIC_REFERENCE';\n\nexport const EXT_KEY_TOPIC_REFERENCE = 'EXT_KEY_TOPIC_REFERENCE';\n","import { FocusMode, OpType } from '@blink-mind/core';\nimport { Flex, ZIndex } from '@blink-mind/renderer-react';\nimport { Button } from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { OP_TYPE_SET_REFERENCE_TOPICS } from './utils';\n\nconst Root = styled(ZIndex)`\n  position: absolute;\n  left: calc(50% - 150px);\n  top: 30px;\n  width: 300px;\n  background: white;\n  padding: 10px;\n  user-select: none;\n`;\n\nconst Title = styled.div`\n  margin-bottom: 10px;\n`;\n\nexport function AddReferenceTopicPanel(props) {\n  const { zIndex, controller, topicKey } = props;\n  const onClickCancel = e => {\n    controller.run('clearSelectedReferenceKeys', props);\n    controller.run('enableOperation', props);\n    controller.run('operation', {\n      ...props,\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FocusMode.NORMAL\n    });\n  };\n  const onClickConfirm = e => {\n    const referenceKeys = controller.run('getSelectedReferenceKeys', props);\n    controller.run('enableOperation', props);\n    controller.run('operation', {\n      ...props,\n      opArray: [\n        {\n          opType: OP_TYPE_SET_REFERENCE_TOPICS,\n          topicKey,\n          referenceKeys\n        },\n        {\n          opType: OpType.FOCUS_TOPIC,\n          topicKey,\n          focusMode: FocusMode.NORMAL\n        }\n      ]\n    });\n    controller.run('clearSelectedReferenceKeys', props);\n  };\n  return (\n    <Root zIndex={zIndex}>\n      <Title>\n        Please select the topics you want to reference. After selection, click\n        the confirm button.\n      </Title>\n      <Flex justifyContent={'space-around'}>\n        <Button onClick={onClickConfirm}>Confirm</Button>\n        <Button onClick={onClickCancel}>Cancel</Button>\n      </Flex>\n    </Root>\n  );\n}\n","import { KeyType } from '@blink-mind/core';\nimport { List, Map, Record } from 'immutable';\n\ntype ReferenceRecordType = {\n  keyList: List<KeyType>;\n  dataMap: Map<KeyType, any>;\n};\n\nconst defaultReferenceRecord: ReferenceRecordType = {\n  keyList: List(),\n  dataMap: Map()\n};\n\nexport class ReferenceRecord extends Record(defaultReferenceRecord) {\n  get keyList(): List<KeyType> {\n    return this.get('keyList');\n  }\n\n  get dataMap(): Map<KeyType, any> {\n    return this.get('dataMap');\n  }\n}\n\ntype ExtDataReferenceRecordType = {\n  reference: Map<KeyType, ReferenceRecord>;\n};\n\nconst defaultExtDataReferenceRecord: ExtDataReferenceRecordType = {\n  reference: Map()\n};\n\nexport class ExtDataReference extends Record(defaultExtDataReferenceRecord) {\n  get reference(): Map<KeyType, ReferenceRecord> {\n    return this.get('reference');\n  }\n\n  getReferenceKeys(topicKey: KeyType): KeyType[] {\n    if (this.reference.has(topicKey)) {\n      return this.reference.get(topicKey).keyList.toArray();\n    }\n    return [];\n  }\n\n  getReferencedKeys(topicKey: KeyType): KeyType[] {\n    const res = [];\n    this.reference.forEach((v, k) => {\n      if (v.keyList.includes(topicKey)) {\n        res.push(k);\n      }\n    });\n    return res;\n  }\n}\n","import { BaseModifierArg, KeyType } from '@blink-mind/core';\nimport { List } from 'immutable';\nimport { ExtDataReference, ReferenceRecord } from './ext-data-reference';\nimport { EXT_DATA_KEY_TOPIC_REFERENCE } from './utils';\n\n// TODO 能否优化这个函数的写法\nexport function setReferenceTopicKeys({\n  model,\n  topicKey,\n  referenceKeys\n}: BaseModifierArg & { referenceKeys: KeyType[] }) {\n  let extData: ExtDataReference = model.getExtDataItem(\n    EXT_DATA_KEY_TOPIC_REFERENCE,\n    ExtDataReference\n  );\n\n  let referenceRecord =\n    extData.reference.get(topicKey) || new ReferenceRecord();\n\n  referenceRecord = referenceRecord.set('keyList', List(referenceKeys));\n  extData = extData.setIn(['reference', topicKey], referenceRecord);\n  model = model.setIn(['extData', EXT_DATA_KEY_TOPIC_REFERENCE], extData);\n\n  return model;\n}\n","import { KeyType } from '@blink-mind/core';\nimport { BaseProps, PropKey } from '@blink-mind/renderer-react';\nimport { Alert, Button } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { useState } from 'react';\nimport styled from 'styled-components';\n\nconst Root = styled.div`\n  display: flex;\n  width: 380px;\n  margin: 10px;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Content = styled.div`\n  width: 300px;\n  text-decoration: underline;\n  cursor: pointer;\n`;\n\nconst ButtonPlace = styled.div`\n  width: 80px;\n`;\n\nexport type ReferenceTopicThumbnailProps = BaseProps & {\n  refKey: KeyType;\n  refType: 'reference' | 'referenced' | undefined | null;\n  removeHandler?: (event: React.MouseEvent<HTMLElement>) => void;\n};\nexport function ReferenceTopicThumbnail(props: ReferenceTopicThumbnailProps) {\n  const { controller, refKey, refType, removeHandler } = props;\n  const [deleteConfirm, setDeleteConfirm] = useState(false);\n  const onClick = e => {\n    e.stopPropagation();\n    controller.run('focusTopicAndMoveToCenter', { ...props, topicKey: refKey });\n  };\n\n  const onClickRemove = e => {\n    setDeleteConfirm(true);\n  };\n\n  const content = controller.getValue(PropKey.TOPIC_TITLE, {\n    ...props,\n    topicKey: refKey,\n    maxLength: 100\n  });\n  const deleteAlertProps = {\n    isOpen: deleteConfirm,\n    cancelButtonText: 'cancel',\n    onConfirm: e => {\n      removeHandler(e);\n    },\n    onCancel: e => {\n      setDeleteConfirm(false);\n    },\n    onClose: e => {\n      setDeleteConfirm(false);\n    }\n  };\n  return (\n    <Root>\n      <Content onClick={onClick}>{content}</Content>\n      <ButtonPlace>\n        {refType === 'reference' && (\n          <>\n            <Button onClick={onClickRemove}>Remove</Button>\n            <Alert {...deleteAlertProps}>\n              <p>Are you confirm to remove this reference?</p>\n            </Alert>\n          </>\n        )}\n      </ButtonPlace>\n    </Root>\n  );\n}\n","import { FocusMode } from '@blink-mind/core';\nimport { BaseProps, cancelEvent } from '@blink-mind/renderer-react';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { ExtDataReference } from './ext-data-reference';\nimport { ReferenceTopicThumbnail } from './reference-topic-thumbnail';\nimport {\n  EXT_DATA_KEY_TOPIC_REFERENCE,\n  OP_TYPE_SET_REFERENCE_TOPICS\n} from './utils';\nconst Root = styled.div``;\n\nconst Group = styled.div`\n  padding: 10px;\n`;\n\nconst GroupList = styled.div`\n  max-height: 200px;\n  overflow: auto;\n`;\n\nconst GroupTitle = styled.div`\n  font-size: 20px;\n  color: #106ba3;\n`;\n\nconst GotoBtn = styled.div`\n  text-decoration: underline;\n  color: #106ba3;\n  cursor: pointer;\n`;\n\nexport function ReferenceTopicList(props: BaseProps) {\n  const { topicKey, controller, model } = props;\n  const extData: ExtDataReference = model.extData.get(\n    EXT_DATA_KEY_TOPIC_REFERENCE\n  );\n\n  const removeReference = refKey => e => {\n    e.stopPropagation();\n    const keyList = extData.reference.get(topicKey).keyList;\n    controller.run('operation', {\n      ...props,\n      opArray: [\n        {\n          opType: OP_TYPE_SET_REFERENCE_TOPICS,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL,\n          referenceKeys: keyList.delete(keyList.indexOf(refKey)).toArray()\n        }\n      ]\n    });\n  };\n\n  const referenceKeys = extData.getReferenceKeys(topicKey);\n\n  const referenceGroup =\n    referenceKeys.length === 0 ? null : (\n      <Group>\n        <GroupTitle>Reference Topics:</GroupTitle>\n        <GroupList>\n          {referenceKeys.map(key => {\n            const thumbProps = {\n              ...props,\n              key,\n              refKey: key,\n              refType: 'reference',\n              removeHandler: removeReference(key)\n            };\n            //@ts-ignore\n            return <ReferenceTopicThumbnail {...thumbProps} />;\n          })}\n        </GroupList>\n      </Group>\n    );\n\n  const referencedKeys = extData.getReferencedKeys(topicKey);\n\n  const referencedGroup =\n    referencedKeys.length === 0 ? null : (\n      <Group>\n        <GroupTitle>Referenced Topics:</GroupTitle>\n        <GroupList>\n          {referencedKeys.map(key => {\n            const thumbProps = {\n              ...props,\n              key,\n              refKey: key,\n              refType: 'referenced'\n            };\n            //@ts-ignore\n            return <ReferenceTopicThumbnail {...thumbProps} />;\n          })}\n        </GroupList>\n      </Group>\n    );\n\n  const onClickGotoOriginTopic = e => {\n    e.stopPropagation();\n    controller.run('focusTopicAndMoveToCenter', props);\n  };\n\n  const currentTopic = model.focusKey !== topicKey && (\n    <Group>\n      <GotoBtn onClick={onClickGotoOriginTopic}>Goto Origin Topic</GotoBtn>\n    </Group>\n  );\n\n  return (\n    <Root onMouseDown={cancelEvent}>\n      {referenceGroup}\n      {referencedGroup}\n      {currentTopic}\n    </Root>\n  );\n}\n","import {\n  BaseProps,\n  iconClassName,\n  TopicBlockIcon\n} from '@blink-mind/renderer-react';\nimport { Popover, PopoverInteractionKind } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { ExtDataReference } from './ext-data-reference';\nimport { ReferenceTopicList } from './reference-topic-list';\nimport { EXT_DATA_KEY_TOPIC_REFERENCE } from './utils';\n\nexport function TopicExtReference(props: BaseProps) {\n  const { model, topicKey } = props;\n  const extData: ExtDataReference =\n    model.extData.get(EXT_DATA_KEY_TOPIC_REFERENCE) || new ExtDataReference();\n  const refRecord = extData.reference.get(topicKey);\n  const referencedKeys = [];\n  extData.reference.forEach((v, k) => {\n    if (v.keyList.includes(topicKey)) referencedKeys.push(k);\n  });\n  if (\n    (refRecord == null || refRecord.keyList.size === 0) &&\n    referencedKeys.length === 0\n  )\n    return null;\n\n  const iconProps = {\n    className: iconClassName('reference'),\n    tabIndex: -1\n  };\n  const icon = <TopicBlockIcon {...iconProps} />;\n  const tooltipContent = <ReferenceTopicList {...props} />;\n  const tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.CLICK,\n    hoverOpenDelay: 500\n  };\n  return <Popover {...tooltipProps}></Popover>;\n}\n","import { StyledCheckbox } from '@blink-mind/renderer-react';\nimport * as React from 'react';\n// useState 在vscode 运行报错 https://reactjs.org/docs/error-decoder.html/?invariant=321，\n// 问题原因，在yarn link package的时候，webpack 会打包进去多个 react-dom.js\nimport { useState } from 'react';\nexport function TopicReferenceCheckbox(props) {\n  const { topicKey, selectedTopicKeys } = props;\n  const a = selectedTopicKeys.has(topicKey);\n  const [checked, setChecked] = useState(a);\n  const checkboxProps = {\n    checked,\n    onChange: () => {\n      if (selectedTopicKeys.has(topicKey)) {\n        selectedTopicKeys.delete(topicKey);\n      } else {\n        selectedTopicKeys.add(topicKey);\n      }\n      setChecked(!checked);\n    }\n  };\n  return <StyledCheckbox {...checkboxProps} />;\n}\n","import {\n  BaseModifierArg,\n  getAllSubTopicKeys,\n  Model,\n  ModelModifier,\n  OpType\n} from '@blink-mind/core';\nimport { Icon, PropKey } from '@blink-mind/renderer-react';\nimport { MenuDivider, MenuItem } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { AddReferenceTopicPanel } from './add-reference-topic-panel';\nimport {\n  EXT_DATA_KEY_TOPIC_REFERENCE,\n  EXT_KEY_TOPIC_REFERENCE,\n  FOCUS_MODE_SET_REFERENCE_TOPICS,\n  OP_TYPE_SET_REFERENCE_TOPICS,\n  OP_TYPE_START_SET_REFERENCE_TOPICS\n} from './utils';\n\nimport { IControllerRunContext } from '@blink-mind/core/src/interfaces';\nimport { List, Map } from 'immutable';\nimport { ExtDataReference, ReferenceRecord } from './ext-data-reference';\nimport { setReferenceTopicKeys } from './op-function';\nimport { TopicExtReference } from './topic-ext-reference';\nimport { TopicReferenceCheckbox } from './topic-reference-checkbox';\n\nexport function TopicReferencePlugin() {\n  let selectedTopicKeys = new Set();\n  function startSetReferenceTopics({ model, topicKey }: BaseModifierArg) {\n    const extData: ExtDataReference = model.getExtDataItem(\n      EXT_DATA_KEY_TOPIC_REFERENCE,\n      ExtDataReference\n    );\n\n    selectedTopicKeys = new Set(extData.getReferenceKeys(topicKey));\n\n    model = ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FOCUS_MODE_SET_REFERENCE_TOPICS\n    });\n    return model;\n  }\n\n  return {\n    customizeTopicContextMenu(props, next) {\n      const { controller } = props;\n      function onClickSetReferenceTopics(e) {\n        controller.run('operation', {\n          ...props,\n          opType: OP_TYPE_START_SET_REFERENCE_TOPICS\n        });\n        controller.run('disableOperation', {\n          ...props,\n          whiteList: [OpType.TOGGLE_COLLAPSE]\n        });\n      }\n      return (\n        <>\n          {next()}\n          <MenuDivider />\n          <MenuItem\n            key={EXT_KEY_TOPIC_REFERENCE}\n            icon={Icon('reference')}\n            text=\"Set Reference Topics\"\n            onClick={onClickSetReferenceTopics}\n          />\n        </>\n      );\n    },\n\n    getOpMap(props, next) {\n      const opMap = next();\n      opMap.set(OP_TYPE_START_SET_REFERENCE_TOPICS, startSetReferenceTopics);\n      opMap.set(OP_TYPE_SET_REFERENCE_TOPICS, setReferenceTopicKeys);\n      return opMap;\n    },\n\n    beforeOpFunction(props, next) {\n      let model: Model = next();\n      const { opType, topicKey } = props;\n      // 注意是在beforeOpFunction里面操作\n      if (\n        opType === OpType.DELETE_TOPIC &&\n        topicKey !== model.editorRootTopicKey\n      ) {\n        const allDeleteKeys = getAllSubTopicKeys(model, topicKey);\n        allDeleteKeys.push(topicKey);\n\n        let extData: ExtDataReference = model.getExtDataItem(\n          EXT_DATA_KEY_TOPIC_REFERENCE,\n          ExtDataReference\n        );\n        let reference = extData.reference;\n        // 注意这里要处理所有被删除的Key\n        allDeleteKeys.forEach((deleteKey: KeyType) => {\n          const referencedKeys = extData.getReferencedKeys(deleteKey);\n\n          // 处理被引用的部分\n          reference = reference.withMutations(reference => {\n            referencedKeys.forEach(v => {\n              reference.updateIn([v, 'keyList'], (keyList: List<KeyType>) =>\n                keyList.delete(keyList.indexOf(deleteKey))\n              );\n            });\n          });\n          // 处理引用的部分\n          if (reference.has(deleteKey)) {\n            reference = reference.delete(deleteKey);\n          }\n        });\n\n        extData = extData.set('reference', reference);\n        model = model.setIn(['extData', EXT_DATA_KEY_TOPIC_REFERENCE], extData);\n      }\n      return model;\n    },\n\n    renderDiagramCustomize(props: IControllerRunContext, next) {\n      const { model, controller } = props;\n      const zIndex =\n        controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX) + 2;\n      const res = next();\n      if (model.focusMode === FOCUS_MODE_SET_REFERENCE_TOPICS) {\n        const panelProps = {\n          ...props,\n          zIndex,\n          topicKey: model.focusKey,\n          key: 'AddReferenceTopicPanel'\n        };\n        res.push(<AddReferenceTopicPanel {...panelProps} />);\n      }\n      return res;\n    },\n\n    renderTopicContentOthers(props, next) {\n      const { model, topicKey, controller } = props;\n      const res = next();\n      res.push(\n        controller.run('renderTopicExtReference', {\n          ...props,\n          key: EXT_KEY_TOPIC_REFERENCE + '-icon'\n        })\n      );\n      if (\n        model.focusMode === FOCUS_MODE_SET_REFERENCE_TOPICS &&\n        model.focusKey !== topicKey\n      ) {\n        const checkBoxProps = { ...props, key: 'checkbox', selectedTopicKeys };\n        const checkbox = <TopicReferenceCheckbox {...checkBoxProps} />;\n        res.push(checkbox);\n      }\n      return res;\n    },\n\n    renderTopicExtReference(props, next) {\n      return <TopicExtReference {...props} />;\n    },\n\n    clearSelectedReferenceKeys() {\n      selectedTopicKeys.clear();\n    },\n\n    getSelectedReferenceKeys() {\n      return Array.from(selectedTopicKeys);\n    },\n\n    //TODO\n    deserializeExtDataItem(props, next) {\n      const { extDataKey, extDataItem } = props;\n      if (extDataKey === EXT_DATA_KEY_TOPIC_REFERENCE) {\n        let extDataReference = new ExtDataReference();\n        for (const key in extDataItem.reference) {\n          const item = extDataItem.reference[key];\n          const referenceRecord = new ReferenceRecord({\n            keyList: List(item.keyList),\n            dataMap: Map(item.dataMap)\n          });\n          extDataReference = extDataReference.update('reference', reference =>\n            reference.set(key, referenceRecord)\n          );\n        }\n        return extDataReference;\n      }\n      return next();\n    }\n  };\n}\n","import { FocusMode, OpType } from '@blink-mind/core';\nimport { BaseProps } from '@blink-mind/renderer-react';\nimport {\n  IInputGroupProps,\n  Popover,\n  PopoverInteractionKind\n} from '@blueprintjs/core';\nimport { ItemListPredicate, ItemRenderer, Omnibar } from '@blueprintjs/select';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport './search-panel.css';\n\nconst NavOmniBar = Omnibar.ofType<INavigationSection>();\n\nconst StyledNavOmniBar = styled(NavOmniBar)`\n  top: 20%;\n  left: 25% !important;\n  width: 50% !important;\n`;\n\nconst TopicTitle = styled.div`\n  margin: 0 5px;\n  padding: 10px 5px;\n  width: 100%;\n  font-size: 16px;\n  cursor: pointer;\n  &:hover {\n    background: #e3e8ec;\n  }\n`;\n\nconst StyledPopover = styled(Popover)`\n  display: block;\n`;\n\nconst Tip = styled.div`\n  padding: 10px;\n  font-size: 16px;\n  //max-width: 800px;\n  //max-height: 600px;\n  overflow: auto;\n`;\n\nconst TipContent = styled.div`\n  white-space: break-spaces;\n`;\n\nexport interface INavigationSection {\n  // path: string[];\n  key: KeyType;\n  title: string;\n}\n\nconst INPUT_PROPS: IInputGroupProps = {\n  placeholder: 'Search'\n};\nexport type SearchPanelProps = BaseProps & {\n  setSearchWord: (s: string) => void;\n};\nexport function SearchPanel(props: SearchPanelProps) {\n  const { model, setSearchWord, controller } = props;\n  const onClose = () => {\n    controller.run('operation', {\n      ...props,\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FocusMode.NORMAL\n    });\n  };\n\n  const getAllSections = () => {\n    const res = [];\n    model.topics.forEach((topic, topicKey) => {\n      res.push({\n        key: topicKey,\n        title: controller.run('getTopicTitle', {\n          ...props,\n          topicKey\n        })\n      });\n    });\n    return res;\n  };\n\n  const navigateToTopic = topicKey => e => {\n    controller.run('focusTopicAndMoveToCenter', { ...props, topicKey });\n  };\n\n  const renderItem: ItemRenderer<INavigationSection> = (section, props) => {\n    // const pathElements = section.path.reduce<React.ReactChild[]>(\n    //   (elems, el) => {\n    //     elems.push(el, <Icon key={el} icon=\"caret-right\" />);\n    //     return elems;\n    //   },\n    //   []\n    // );\n    const { key, title: sectionTitle } = section;\n    const maxLength = 100;\n    const needTip = sectionTitle.length > maxLength;\n    const title = needTip\n      ? sectionTitle.substr(0, maxLength) + '...'\n      : sectionTitle;\n    const titleProps = {\n      key,\n      onClick: navigateToTopic(key)\n    };\n    const titleEl = <TopicTitle {...titleProps}>{title}</TopicTitle>;\n    const tip = (\n      <Tip>\n        <TipContent>{sectionTitle}</TipContent>\n      </Tip>\n    );\n    const popoverProps = {\n      key,\n      target: titleEl,\n      content: tip,\n      fill: true,\n      interactionKind: PopoverInteractionKind.HOVER_TARGET_ONLY,\n      hoverOpenDelay: 1000\n    };\n    return needTip ? <StyledPopover {...popoverProps} /> : titleEl;\n  };\n\n  const filterMatches: ItemListPredicate<INavigationSection> = (\n    query,\n    items\n  ) => {\n    return items.filter(item =>\n      item.title.toLowerCase().includes(query.toLowerCase())\n    );\n  };\n\n  const sections = getAllSections();\n\n  return (\n    <StyledNavOmniBar\n      inputProps={INPUT_PROPS}\n      itemListPredicate={filterMatches}\n      isOpen={true}\n      items={sections}\n      itemRenderer={renderItem}\n      // onItemSelect={handleItemSelect}\n      onClose={onClose}\n      resetOnSelect={true}\n    />\n  );\n}\n","export const HOT_KEY_NAME_SEARCH = 'DEFAULT_SEARCH';\nexport const FOCUS_MODE_SEARCH = 'FOCUS_MODE_SEARCH';\n","import { OpType } from '@blink-mind/core';\nimport { HotKeysConfig } from '@blink-mind/renderer-react';\nimport * as React from 'react';\nimport { SearchPanel } from './search-panel';\nimport { FOCUS_MODE_SEARCH, HOT_KEY_NAME_SEARCH } from './utils';\n\nexport function SearchPlugin() {\n  let searchWord: string;\n  const setSearchWorld = s => {\n    searchWord = s;\n  };\n  return {\n    customizeHotKeys(props, next): HotKeysConfig {\n      const { controller, model } = props;\n      const hotKeys: HotKeysConfig = next();\n\n      hotKeys.globalHotKeys.set(HOT_KEY_NAME_SEARCH, {\n        label: 'search',\n        combo: 'ctrl + f',\n        onKeyDown: () => {\n          controller.run('operation', {\n            ...props,\n            opType: OpType.FOCUS_TOPIC,\n            topicKey: model.focusKey,\n            focusMode: FOCUS_MODE_SEARCH\n          });\n        }\n      });\n      return hotKeys;\n    },\n\n    renderDiagramCustomize(props, next) {\n      const res = next();\n      const { model } = props;\n      if (model.focusMode === FOCUS_MODE_SEARCH) {\n        const searchPanelProps = {\n          key: 'search-panel',\n          ...props,\n          setSearchWorld\n        };\n        res.push(<SearchPanel {...searchPanelProps} />);\n      }\n      return res;\n    }\n  };\n}\n"],"names":["React.createElement","Root"],"mappings":"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"}